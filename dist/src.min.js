!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.FacetedSearch=t()}}(function(){var t;return function t(e,n,r){function i(o,a){if(!n[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return i(n?n:t)},u,u.exports,t,e,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){function r(t,e){return f.isUndefined(e)?""+e:f.isNumber(e)&&!isFinite(e)?e.toString():f.isFunction(e)||f.isRegExp(e)?e.toString():e}function i(t,e){return f.isString(t)?t.length<e?t:t.slice(0,e):t}function s(t){return i(JSON.stringify(t.actual,r),128)+" "+t.operator+" "+i(JSON.stringify(t.expected,r),128)}function o(t,e,n,r,i){throw new y.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function a(t,e){t||o(t,!0,e,"==",y.ok)}function l(t,e){if(t===e)return!0;if(f.isBuffer(t)&&f.isBuffer(e)){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return f.isDate(t)&&f.isDate(e)?t.getTime()===e.getTime():f.isRegExp(t)&&f.isRegExp(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:f.isObject(t)||f.isObject(e)?u(t,e):t==e}function c(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function u(t,e){if(f.isNullOrUndefined(t)||f.isNullOrUndefined(e))return!1;if(t.prototype!==e.prototype)return!1;if(f.isPrimitive(t)||f.isPrimitive(e))return t===e;var n=c(t),r=c(e);if(n&&!r||!n&&r)return!1;if(n)return t=d.call(t),e=d.call(e),l(t,e);var i,s,o=v(t),a=v(e);if(o.length!=a.length)return!1;for(o.sort(),a.sort(),s=o.length-1;s>=0;s--)if(o[s]!=a[s])return!1;for(s=o.length-1;s>=0;s--)if(i=o[s],!l(t[i],e[i]))return!1;return!0}function h(t,e){return!(!t||!e)&&("[object RegExp]"==Object.prototype.toString.call(e)?e.test(t):t instanceof e||e.call({},t)===!0)}function p(t,e,n,r){var i;f.isString(n)&&(r=n,n=null);try{e()}catch(t){i=t}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&o(i,n,"Missing expected exception"+r),!t&&h(i,n)&&o(i,n,"Got unwanted exception"+r),t&&i&&n&&!h(i,n)||!t&&i)throw i}var f=t("util/"),d=Array.prototype.slice,g=Object.prototype.hasOwnProperty,y=e.exports=a;y.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=s(this),this.generatedMessage=!0);var e=t.stackStartFunction||o;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=e.name,a=r.indexOf("\n"+i);if(a>=0){var l=r.indexOf("\n",a+1);r=r.substring(l+1)}this.stack=r}}},f.inherits(y.AssertionError,Error),y.fail=o,y.ok=a,y.equal=function(t,e,n){t!=e&&o(t,e,n,"==",y.equal)},y.notEqual=function(t,e,n){t==e&&o(t,e,n,"!=",y.notEqual)},y.deepEqual=function(t,e,n){l(t,e)||o(t,e,n,"deepEqual",y.deepEqual)},y.notDeepEqual=function(t,e,n){l(t,e)&&o(t,e,n,"notDeepEqual",y.notDeepEqual)},y.strictEqual=function(t,e,n){t!==e&&o(t,e,n,"===",y.strictEqual)},y.notStrictEqual=function(t,e,n){t===e&&o(t,e,n,"!==",y.notStrictEqual)},y.throws=function(t,e,n){p.apply(this,[!0].concat(d.call(arguments)))},y.doesNotThrow=function(t,e){p.apply(this,[!1].concat(d.call(arguments)))},y.ifError=function(t){if(t)throw t};var v=Object.keys||function(t){var e=[];for(var n in t)g.call(t,n)&&e.push(n);return e}},{"util/":11}],2:[function(t,e,n){},{}],3:[function(t,e,n){(function(){e.exports={el:function(t){return{closest:function(e){var n;for(n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t;){if(n.bind(t)(e))return t;t=t.parentNode}},position:function(e){var n,r,i;for(null==e&&(e=document.body),n=0,i=0,r=t;null!=r&&r!==e&&!this.hasDescendant(e);)n+=r.offsetLeft,i+=r.offsetTop,r=r.offsetParent;return{left:n,top:i}},boundingBox:function(){var e;return e=this.position(),e.width=t.clientWidth,e.height=t.clientHeight,e.right=e.left+e.width,e.bottom=e.top+e.height,e},hasDescendant:function(e){var n;for(n=e.parentNode;null!=n;){if(n===t)return!0;n=n.parentNode}return!1},insertAfter:function(e){return e.parentNode.insertBefore(t,e.nextSibling)},hasScrollBar:function(t){return hasScrollBarX(t)||hasScrollBarY(t)},hasScrollBarX:function(t){return t.scrollWidth>t.clientWidth},hasScrollBarY:function(t){return t.scrollHeight>t.clientHeight},inViewport:function(e){var n,r,i;return i=null!=e?e:window,n=null!=e?e:document.documentElement,r=t.getBoundingClientRect(),r.top>=0&&r.left>=0&&r.bottom<=(i.innerHeight||n.clientHeight)&&r.right<=(i.innerWidth||n.clientWidth)}}}}}).call(this)},{}],4:[function(t,e,n){(function(){var t={}.hasOwnProperty;e.exports={get:function(t,e){return null==e&&(e={}),this._sendRequest("GET",t,e)},post:function(t,e){return null==e&&(e={}),this._sendRequest("POST",t,e)},put:function(t,e){return null==e&&(e={}),this._sendRequest("PUT",t,e)},_promise:function(){return{done:function(t){return this.callDone=t},callDone:null,fail:function(t){return this.callFail=t},callFail:null,always:function(t){return this.callAlways=t},callAlways:null}},_sendRequest:function(e,n,r){var i,s,o,a,l;null==r&&(r={}),s=this._promise(),null==r.headers&&(r.headers={}),a=new XMLHttpRequest,a.onreadystatechange=function(){var t;if(4===a.readyState)if(null!=s.callAlways&&s.callAlways(a),200<=(t=a.status)&&t<=206||1223===a.status){if(null!=s.callDone)return s.callDone(a)}else if(null!=s.callFail)return s.callFail(a)},a.open(e,n,!0),a.setRequestHeader("Content-type","application/json"),l=r.headers;for(i in l)t.call(l,i)&&(o=l[i],a.setRequestHeader(i,o));return a.send(r.data),s}}}).call(this)},{}],5:[function(t,e,n){(function(){e.exports={generateID:function(t){var e,n;for(t=null!=t&&t>0?t-1:7,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e.charAt(Math.floor(52*Math.random()));t--;)n+=e.charAt(Math.floor(Math.random()*e.length));return n},setResetTimeout:function(){var t;return t=null,function(e,n,r){return null!=t&&(null!=r&&r(),clearTimeout(t)),t=setTimeout(function(){return t=null,n()},e)}}()}}).call(this)},{}],6:[function(e,n,r){(function(i){!function(e){if("object"==typeof r&&"undefined"!=typeof n)n.exports=e();else if("function"==typeof t&&t.amd)t([],e);else{var s;s="undefined"!=typeof window?window:"undefined"!=typeof i?i:"undefined"!=typeof self?self:this,s.Pagination=e()}}(function(){var t;return function t(n,r,i){function s(a,l){if(!r[a]){if(!n[a]){var c="function"==typeof e&&e;if(!l&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=r[a]={exports:{}};n[a][0].call(h.exports,function(t){var e=n[a][1][t];return s(e?e:t)},h,h.exports,t,n,r,i)}return r[a].exports}for(var o="function"==typeof e&&e,a=0;a<i.length;a++)s(i[a]);return s}({1:[function(t,e,n){var r,i,s,o,a,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;i=t("backbone"),r=t("jquery"),i.$=r,a=t("funcky.util"),o=t("./main.jade"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.tagName="ul",e.prototype.className="hibb-pagination",e.prototype.initialize=function(t){var e,n;return this.options=null!=t?t:{},null==(e=this.options).step10&&(e.step10=!0),null==(n=this.options).triggerPageNumber&&(n.triggerPageNumber=!0),this._currentPageNumber=null!=this.options.resultsStart&&this.options.resultsStart>0?this.options.resultsStart/this.options.resultsPerPage+1:1,this.setPageNumber(this._currentPageNumber,!0)},e.prototype.render=function(){var t;return this._pageCount=Math.ceil(this.options.resultsTotal/this.options.resultsPerPage),t=r.extend(this.options,{currentPageNumber:this._currentPageNumber,pageCount:this._pageCount}),this.el.innerHTML=o(t),this._pageCount<=1&&this.$el.hide(),this},e.prototype.events=function(){return{"click li.prev10.active":"_handlePrev10","click li.prev.active":"_handlePrev","click li.next.active":"_handleNext","click li.next10.active":"_handleNext10","click li.current:not(.active)":"_handleCurrentClick","blur li.current.active input":"_handleBlur","keyup li.current.active input":"_handleKeyup"}},e.prototype._handlePrev10=function(){return this.setPageNumber(this._currentPageNumber-10)},e.prototype._handlePrev=function(){return this.setPageNumber(this._currentPageNumber-1)},e.prototype._handleNext=function(){return this.setPageNumber(this._currentPageNumber+1)},e.prototype._handleNext10=function(){return this.setPageNumber(this._currentPageNumber+10)},e.prototype._handleCurrentClick=function(t){var e,n,r;return r=this.$(t.currentTarget),n=r.find("span"),e=r.find("input"),e.width(n.width()),r.addClass("active"),e.animate({width:40},"fast"),e.focus(),e.val(this._currentPageNumber)},e.prototype._handleKeyup=function(t){var e,n;if(e=this.$(t.currentTarget),n=+e.val(),13===t.keyCode)return 1<=n&&n<=this._pageCount&&this.setPageNumber(n),this._deactivateCurrentLi(e)},e.prototype._handleBlur=function(t){return this._deactivateCurrentLi(this.$(t.currentTarget))},e.prototype._deactivateCurrentLi=function(t){return t.animate({width:0},"fast",function(){var e;return e=t.parent(),e.removeClass("active")})},e.prototype.getCurrentPageNumber=function(){return this._currentPageNumber},e.prototype.setPageNumber=function(t,e){var n;if(null==e&&(e=!1),this.triggerPageNumber||(n=t<this._currentPageNumber?"prev":"next",this.trigger(n)),this._currentPageNumber=t,this.render(),!e)return a.setResetTimeout(500,function(e){return function(){return e.trigger("change:pagenumber",t)}}(this))},e.prototype.destroy=function(){return this.remove()},e}(i.View),e.exports=s},{"./main.jade":5,backbone:void 0,"funcky.util":3,jquery:void 0}],2:[function(t,e,n){},{}],3:[function(t,e,n){(function(){e.exports={generateID:function(t){var e,n;for(t=null!=t&&t>0?t-1:7,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e.charAt(Math.floor(52*Math.random()));t--;)n+=e.charAt(Math.floor(Math.random()*e.length));return n},setResetTimeout:function(){var t;return t=null,function(e,n,r){return null!=t&&(null!=r&&r(),clearTimeout(t)),t=setTimeout(function(){return t=null,n()},e)}}()}}).call(this)},{}],4:[function(e,n,r){(function(i){!function(e){if("object"==typeof r&&"undefined"!=typeof n)n.exports=e();else if("function"==typeof t&&t.amd)t([],e);else{var s;"undefined"!=typeof window?s=window:"undefined"!=typeof i?s=i:"undefined"!=typeof self&&(s=self),s.jade=e()}}(function(){return function t(n,r,i){function s(a,l){if(!r[a]){if(!n[a]){var c="function"==typeof e&&e;if(!l&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=r[a]={exports:{}};n[a][0].call(h.exports,function(t){var e=n[a][1][t];return s(e?e:t)},h,h.exports,t,n,r,i)}return r[a].exports}for(var o="function"==typeof e&&e,a=0;a<i.length;a++)s(i[a]);return s}({1:[function(t,e,n){"use strict";function r(t){return null!=t&&""!==t}function i(t){return(Array.isArray(t)?t.map(i):t&&"object"==typeof t?Object.keys(t).filter(function(e){return t[e]}):[t]).filter(r).join(" ")}n.merge=function t(e,n){if(1===arguments.length){for(var i=e[0],s=1;s<e.length;s++)i=t(i,e[s]);return i}var o=e.class,a=n.class;(o||a)&&(o=o||[],a=a||[],Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]),e.class=o.concat(a).filter(r));for(var l in n)"class"!=l&&(e[l]=n[l]);return e},n.joinClasses=i,n.cls=function(t,e){for(var r=[],s=0;s<t.length;s++)e&&e[s]?r.push(n.escape(i([t[s]]))):r.push(i(t[s]));var o=i(r);return o.length?' class="'+o+'"':""},n.style=function(t){return t&&"object"==typeof t?Object.keys(t).map(function(e){return e+":"+t[e]}).join(";"):t},n.attr=function(t,e,r,i){return"style"===t&&(e=n.style(e)),"boolean"==typeof e||null==e?e?" "+(i?t:t+'="'+t+'"'):"":0==t.indexOf("data")&&"string"!=typeof e?(JSON.stringify(e).indexOf("&")!==-1&&console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"),e&&"function"==typeof e.toISOString&&console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0")," "+t+"='"+JSON.stringify(e).replace(/'/g,"&apos;")+"'"):r?(e&&"function"==typeof e.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+t+'="'+n.escape(e)+'"'):(e&&"function"==typeof e.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+t+'="'+e+'"')},n.attrs=function(t,e){var r=[],s=Object.keys(t);if(s.length)for(var o=0;o<s.length;++o){var a=s[o],l=t[a];"class"==a?(l=i(l))&&r.push(" "+a+'="'+l+'"'):r.push(n.attr(a,l,!1,e))}return r.join("")},n.escape=function(t){var e=String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return e===""+t?t:e},n.rethrow=function e(n,r,i,s){if(!(n instanceof Error))throw n;if(!("undefined"==typeof window&&r||s))throw n.message+=" on line "+i,n;try{s=s||t("fs").readFileSync(r,"utf8")}catch(t){e(n,null,i)}var o=3,a=s.split("\n"),l=Math.max(i-o,0),c=Math.min(a.length,i+o),o=a.slice(l,c).map(function(t,e){var n=e+l+1;return(n==i?"  > ":"    ")+n+"| "+t}).join("\n");throw n.path=r,n.message=(r||"Jade")+":"+i+"\n"+o+"\n\n"+n.message,n}},{fs:2}],2:[function(t,e,n){},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{fs:2}],5:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i=t||{};return function(t,i,s,o){o&&i>=10&&n.push('<li title="Jump 10 pages back"'+r.cls(["prev10",t>10?"active":""],[null,!0])+">&laquo;</li>"),n.push('<li title="Previous page"'+r.cls(["prev",t>1?"active":""],[null,!0])+">&lsaquo;</li>"),null!=s&&n.push('<li class="pageNameSingular">'+r.escape(null==(e=s[0])?"":e)+"</li>"),n.push('<li title="Edit current page" class="current"><input type="text"'+r.attr("value",t,!0,!1)+"/><span>"+r.escape(null==(e=t)?"":e)+'</span></li><li class="text">of</li><li class="pagecount">'+r.escape(null==(e=i)?"":e)+"</li>"),null!=s&&n.push('<li class="pageNamePlural">'+r.escape(null==(e=s[1])?"":e)+"</li>"),n.push('<li title="Next page"'+r.cls(["next",t<i?"active":""],[null,!0])+">&rsaquo;</li>"),o&&i>=10&&n.push('<li title="Jump 10 pages forward"'+r.cls(["next10",t<=i-10?"active":""],[null,!0])+">&raquo;</li>")}.call(this,"currentPageNumber"in i?i.currentPageNumber:"undefined"!=typeof currentPageNumber?currentPageNumber:void 0,"pageCount"in i?i.pageCount:"undefined"!=typeof pageCount?pageCount:void 0,"showPageNames"in i?i.showPageNames:"undefined"!=typeof showPageNames?showPageNames:void 0,"step10"in i?i.step10:"undefined"!=typeof step10?step10:void 0),n.join("")}},{"jade/runtime":4}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,n,r){(function(i){!function(e){if("object"==typeof r&&"undefined"!=typeof n)n.exports=e();else if("function"==typeof t&&t.amd)t([],e);else{var s;s="undefined"!=typeof window?window:"undefined"!=typeof i?i:"undefined"!=typeof self?self:this,s.jade=e()}}(function(){return function t(n,r,i){function s(a,l){if(!r[a]){if(!n[a]){var c="function"==typeof e&&e;if(!l&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=r[a]={exports:{}};n[a][0].call(h.exports,function(t){var e=n[a][1][t];return s(e?e:t)},h,h.exports,t,n,r,i)}return r[a].exports}for(var o="function"==typeof e&&e,a=0;a<i.length;a++)s(i[a]);return s}({1:[function(t,e,n){"use strict";function r(t){return null!=t&&""!==t}function i(t){return(Array.isArray(t)?t.map(i):t&&"object"==typeof t?Object.keys(t).filter(function(e){return t[e]}):[t]).filter(r).join(" ")}function s(t){return a[t]||t}function o(t){var e=String(t).replace(l,s);return e===""+t?t:e}n.merge=function t(e,n){if(1===arguments.length){for(var i=e[0],s=1;s<e.length;s++)i=t(i,e[s]);return i}var o=e.class,a=n.class;(o||a)&&(o=o||[],a=a||[],Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]),e.class=o.concat(a).filter(r));for(var l in n)"class"!=l&&(e[l]=n[l]);return e},n.joinClasses=i,n.cls=function(t,e){for(var r=[],s=0;s<t.length;s++)e&&e[s]?r.push(n.escape(i([t[s]]))):r.push(i(t[s]));var o=i(r);return o.length?' class="'+o+'"':""},n.style=function(t){return t&&"object"==typeof t?Object.keys(t).map(function(e){return e+":"+t[e]}).join(";"):t},n.attr=function(t,e,r,i){return"style"===t&&(e=n.style(e)),"boolean"==typeof e||null==e?e?" "+(i?t:t+'="'+t+'"'):"":0==t.indexOf("data")&&"string"!=typeof e?(JSON.stringify(e).indexOf("&")!==-1&&console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"),e&&"function"==typeof e.toISOString&&console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0")," "+t+"='"+JSON.stringify(e).replace(/'/g,"&apos;")+"'"):r?(e&&"function"==typeof e.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+t+'="'+n.escape(e)+'"'):(e&&"function"==typeof e.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+t+'="'+e+'"')},n.attrs=function(t,e){var r=[],s=Object.keys(t);if(s.length)for(var o=0;o<s.length;++o){var a=s[o],l=t[a];"class"==a?(l=i(l))&&r.push(" "+a+'="'+l+'"'):r.push(n.attr(a,l,!1,e))}return r.join("")};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},l=/[&<>"]/g;n.escape=o,n.rethrow=function e(n,r,i,s){if(!(n instanceof Error))throw n;if(!("undefined"==typeof window&&r||s))throw n.message+=" on line "+i,n;try{s=s||t("fs").readFileSync(r,"utf8")}catch(t){e(n,null,i)}var o=3,a=s.split("\n"),l=Math.max(i-o,0),c=Math.min(a.length,i+o),o=a.slice(l,c).map(function(t,e){var n=e+l+1;return(n==i?"  > ":"    ")+n+"| "+t}).join("\n");throw n.path=r,n.message=(r||"Jade")+":"+i+"\n"+o+"\n\n"+n.message,n},n.DebugItem=function(t,e){this.lineno=t,this.filename=e}},{fs:2}],2:[function(t,e,n){},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{fs:2}],8:[function(t,e,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(t){if(h===setTimeout)return setTimeout(t,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function o(t){if(p===clearTimeout)return clearTimeout(t);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function a(){y&&d&&(y=!1,d.length?g=d.concat(g):v=-1,g.length&&l())}function l(){if(!y){var t=s(a);y=!0;for(var e=g.length;e;){for(d=g,g=[];++v<e;)d&&d[v].run();v=-1,e=g.length}d=null,y=!1,o(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var h,p,f=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r}catch(t){h=r}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(t){p=i}}();var d,g=[],y=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];g.push(new c(t,e)),1!==g.length||y||s(l)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],9:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],10:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],11:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:o};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(e)?r.showHidden=e:e&&n._extend(r,e),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=s),l(r,t,r.depth)}function s(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function o(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function l(t,e,r){if(t.customInspect&&e&&S(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return b(i)||(i=l(t,i,r)),i}var s=c(t,e);if(s)return s;var o=Object.keys(e),g=a(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),O(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return u(e);if(0===o.length){if(S(e)){var y=e.name?": "+e.name:"";return t.stylize("[Function"+y+"]","special")}if(_(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(k(e))return t.stylize(Date.prototype.toString.call(e),"date");if(O(e))return u(e)}var v="",m=!1,w=["{","}"];if(d(e)&&(m=!0,w=["[","]"]),S(e)){var x=e.name?": "+e.name:"";v=" [Function"+x+"]"}if(_(e)&&(v=" "+RegExp.prototype.toString.call(e)),k(e)&&(v=" "+Date.prototype.toUTCString.call(e)),O(e)&&(v=" "+u(e)),0===o.length&&(!m||0==e.length))return w[0]+v+w[1];if(r<0)return _(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var M;return M=m?h(t,e,r,g,o):o.map(function(n){return p(t,e,r,g,n,m)}),t.seen.pop(),f(M,v,w)}function c(t,e){if(x(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return m(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function u(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i){for(var s=[],o=0,a=e.length;o<a;++o)j(e,String(o))?s.push(p(t,e,n,r,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(p(t,e,n,r,i,!0))}),s}function p(t,e,n,r,i,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),j(r,i)||(o="["+i+"]"),a||(t.seen.indexOf(c.value)<0?(a=y(n)?l(t,c.value,null):l(t,c.value,n-1),a.indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),x(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function f(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function y(t){return null===t}function v(t){return null==t}function m(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function x(t){return void 0===t}function _(t){return M(t)&&"[object RegExp]"===T(t)}function M(t){return"object"==typeof t&&null!==t}function k(t){return M(t)&&"[object Date]"===T(t)}function O(t){return M(t)&&("[object Error]"===T(t)||t instanceof Error)}function S(t){return"function"==typeof t}function C(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function T(t){return Object.prototype.toString.call(t)}function P(t){return t<10?"0"+t.toString(10):t.toString(10)}function L(){var t=new Date,e=[P(t.getHours()),P(t.getMinutes()),P(t.getSeconds())].join(":");return[t.getDate(),q[t.getMonth()],e].join(" ")}function j(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var N=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,s=r.length,o=String(t).replace(N,function(t){if("%%"===t)return"%";if(n>=s)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];n<s;a=r[++n])o+=y(a)||!M(a)?" "+a:" "+i(a);return o},n.deprecate=function(t,i){function s(){if(!o){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),o=!0}return t.apply(this,arguments)}if(x(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var o=!1;return s};var F,z={};n.debuglog=function(t){if(x(F)&&(F=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!z[t])if(new RegExp("\\b"+t+"\\b","i").test(F)){var r=e.pid;z[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else z[t]=function(){};return z[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=y,n.isNullOrUndefined=v,n.isNumber=m,n.isString=b,n.isSymbol=w,n.isUndefined=x,n.isRegExp=_,n.isObject=M,n.isDate=k,n.isError=O,n.isFunction=S,n.isPrimitive=C,n.isBuffer=t("./support/isBuffer");var q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",L(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!M(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,_process:8,inherits:9}],12:[function(t,e,n){var r,i,s,o,a,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;r=t("backbone"),o=t("underscore"),i=t("../models/searchresult"),a=t("funcky.req"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.model=i,e.prototype._cachedModels=null,e.prototype.initialize=function(t,e){return this.options=e,this._cachedModels={}},e.prototype.clearCache=function(){return this._cachedModels={}},e.prototype.getCurrent=function(){return this._current},e.prototype._setCurrent=function(t,e){return this._current=t,this.trigger(e,this._current)},e.prototype._addModel=function(t,e,n,r){return e.location=t,this._cachedModels[n]=new this.model(e),this.add(this._cachedModels[n]),this._setCurrent(this._cachedModels[n],r)},e.prototype.runQuery=function(t,e){var n,r;return null==e&&(e={}),null==e.cache&&(e.cache=!0),n="change:results",r=JSON.stringify(t),e.cache&&this._cachedModels.hasOwnProperty(r)?this._setCurrent(this._cachedModels[r],n):this.postQuery(t,function(t){return function(e){var i;return i=e+"?rows="+t.options.config.get("resultRows"),t.getResults(i,function(i){return t._addModel(e,i,r,n)})}}(this))},e.prototype.moveCursor=function(t){var e,n;if(n="_prev"===t||"_next"===t?this._current.get(t):t,e="change:cursor",null!=n)return this._cachedModels.hasOwnProperty(n)?this._setCurrent(this._cachedModels[n],e):this.getResults(n,function(t){return function(r){return t._addModel(t._current.get("location"),r,n,e)}}(this))},e.prototype.page=function(t,e){var n,r,i;return n="change:page",r=this.options.config.get("resultRows")*(t-1),i=this._current.get("location")+("?rows="+this.options.config.get("resultRows")+"&start="+r),null!=e&&(i+="&database="+e),this._cachedModels.hasOwnProperty(i)?this._setCurrent(this._cachedModels[i],n):this.getResults(i,function(t){return function(e){return t._addModel(t._current.get("location"),e,i,n)}}(this))},e.prototype.postQuery=function(t,e){var n,r;return this.trigger("request"),n={data:JSON.stringify(t),xhrFields:{withCredentials:!0}},console.log("POST options: ",n),this.options.config.has("null null"!==this.options.config.get("authorizationHeaderToken"))&&(n.headers={Authorization:this.options.config.get("authorizationHeaderToken")}),this.options.config.has("requestOptions")&&o.extend(n,this.options.config.get("requestOptions")),r=a.post(this.options.config.get("baseUrl")+this.options.config.get("searchPath"),n),r.done(function(t){return function(t){if(201===t.status)return e(t.getResponseHeader("Location"));throw new Error("Server should return status: 201.",t)}}(this)),r.fail(function(t){return function(e){if(console.log(e),401===e.status)return t.trigger("unauthorized");throw t.trigger("request:failed",e),new Error("Failed posting FacetedSearch queryOptions to the server!",e)}}(this))},e.prototype.getResults=function(t,e){var n,r;return this.trigger("request"),n={xhrFields:{withCredentials:!0}},this.options.config.has("null null"!==this.options.config.get("authorizationHeaderToken"))&&(n.headers={Authorization:this.options.config.get("authorizationHeaderToken")}),console.log("GET options: ",n),r=a.get(t,n),r.done(function(t){return function(n){return e(JSON.parse(n.responseText)),t.trigger("sync")}}(this)),r.fail(function(t){return function(e){if(401===e.status)return t.trigger("unauthorized");throw t.trigger("request:failed",e),new Error("Failed getting FacetedSearch results from the server!",e)}}(this))},e}(r.Collection),e.exports=s},{"../models/searchresult":19,backbone:void 0,"funcky.req":4,underscore:void 0}],13:[function(t,e,n){var r,i,s,o,a,l,c,u,h,p,f,d,g,y,v,m=function(t,e){function n(){this.constructor=t}for(var r in e)b.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},b={}.hasOwnProperty;i=t("backbone"),r=t("jquery"),i.$=r,g=t("assert"),d=t("underscore"),y=t("funcky.el").el,o=t("./models/config"),u=t("./models/query-options"),p=t("./collections/searchresults"),f=t("./views/text-search"),a=t("./views/facets"),h=t("./views/results"),l=t("./views/facets/list"),s=t("./views/facets/boolean"),v=t("../jade/main.jade"),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.facets=null,e.prototype.initialize=function(t){var e;if(this.options=null!=t?t:{},e=d.clone(this.options),delete e.facetViewMap,this.extendConfig(e),"simple"!==this.config.get("textSearch")&&"advanced"!==this.config.get("textSearch")||this.initTextSearch(),this.initQueryOptions(),this.initSearchResults(),this.render(),this.config.get("development"))return this.searchResults.add(JSON.parse(localStorage.getItem("faceted-search-dev-model"))),this.searchResults.cachedModels['{"facetValues":[],"sortParameters":[]}']=this.searchResults.first(),setTimeout(function(t){return function(){return t.$(".overlay").hide()}}(this),100)},e.prototype.render=function(){return this.config.get("templates").hasOwnProperty("main")&&(v=this.config.get("templates").main),
this.el.innerHTML=v(),this.initFacets(),this.$(".faceted-search").addClass("search-type-"+this.config.get("textSearch")),this.renderTextSearch(),this.config.get("results")&&this.renderResults(),this},e.prototype.initTextSearch=function(){return this.textSearch=new f({config:this.config}),this.listenTo(this.textSearch,"change",function(t){return function(e){return t.queryOptions.set(e,{silent:!0})}}(this)),this.listenTo(this.textSearch,"search",function(t){return function(){return t.search()}}(this))},e.prototype.renderTextSearch=function(){var t;if(null!=this.textSearch)return this.textSearch.render(),t=this.el.querySelector(".text-search-placeholder"),t.parentNode.replaceChild(this.textSearch.el,t)},e.prototype.renderResults=function(){return this.$el.addClass("with-results"),this.results=new h({el:this.$(".results"),config:this.config,searchResults:this.searchResults}),this.listenTo(this.results,"result:click",function(t){return this.trigger("result:click",t)}),this.listenTo(this.results,"result:layer-click",function(t,e){return this.trigger("result:layer-click",t,e)}),this.listenTo(this.results,"change:sort-levels",function(t){return this.sortResultsBy(t)}),this.listenTo(this.results,"render:finished",function(t){return function(){return t.trigger("results:render:finished")}}(this))},e.prototype.events=function(){return{"click ul.facets-menu li.collapse-expand":function(t){return this.facets.toggle(t)},"click ul.facets-menu li.reset":"onReset","click ul.facets-menu li.switch button":"onSwitchType"}},e.prototype.onSwitchType=function(t){var e;return t.preventDefault(),e="advanced"===this.config.get("textSearch")?"simple":"advanced",this.config.set({textSearch:e}),this.$(".faceted-search").toggleClass("search-type-simple"),this.$(".faceted-search").toggleClass("search-type-advanced"),1===this.searchResults.length?this.search():this.searchResults.length>1?this.update():void 0},e.prototype.onReset=function(t){return t.preventDefault(),this.reset()},e.prototype.extendConfig=function(t){var e,n,r;n={facetDisplayNames:null,textSearchOptions:null,labels:null};for(e in n)r=n[e],n[e]=t[e],delete t[e];this.config=new o(t);for(e in n)r=n[e],this.config.set(e,d.extend(this.config.get(e),r));return["none","simple","advanced"].indexOf(this.config.get("textSearch"))===-1&&this.config.set({textSearch:"advanced"}),this.listenTo(this.config,"change:resultRows",function(t){return function(){return t.refresh()}}(this))},e.prototype.initQueryOptions=function(){var t,e,n,r,i;if(t=this.config.get("queryOptions"),null!=this.textSearch&&(t=d.extend(this.config.get("queryOptions"),this.textSearch.model.attributes),delete t.term),this.config.get("levels").length>0)for(t.sortParameters=[],i=this.config.get("levels"),e=0,n=i.length;e<n;e++)r=i[e],t.sortParameters.push({fieldname:r,direction:"asc"});if(this.queryOptions=new u(t),this.config.get("autoSearch"))return this.listenTo(this.queryOptions,"change",function(t){return function(){return t.search()}}(this))},e.prototype.initSearchResults=function(){return this.searchResults=new p(null,{config:this.config}),this.listenToOnce(this.searchResults,"change:results",function(t){return function(e){return t.config.handleFirstResponseModel(e)}}(this)),this.listenTo(this.searchResults,"change:results",function(t){return function(e){return"simple"!==t.config.get("textSearch")&&t.update(),t.trigger("change:results",e)}}(this)),this.listenTo(this.searchResults,"change:cursor",function(t){return function(e){return t.trigger("change:cursor",e)}}(this)),this.listenTo(this.searchResults,"change:page",function(t){return function(e,n){return t.trigger("change:page",e,n)}}(this)),this.listenTo(this.searchResults,"request",function(t){return function(){return t.showLoader()}}(this)),this.listenTo(this.searchResults,"sync",function(t){return function(){return t.hideLoader()}}(this)),this.listenTo(this.searchResults,"unauthorized",function(t){return function(){return t.trigger("unauthorized")}}(this)),this.listenTo(this.searchResults,"request:failed",function(t){return function(e){return t.trigger("request:failed",e)}}(this))},e.prototype.initFacets=function(){var t;return this.facets=new a({viewMap:this.options.facetViewMap,config:this.config}),t=this.el.querySelector(".facets-placeholder"),t.parentNode.replaceChild(this.facets.el,t),this.listenTo(this.facets,"change",function(t){return function(e,n){return t.queryOptions.set(e,n)}}(this))},e.prototype.showLoader=function(){var t,e;return e=this.el.querySelector(".overlay"),"block"!==e.style.display&&(t=function(t){return function(){var n,r,i,s,o;return n=t.el.querySelector(".faceted-search"),r=y(n).boundingBox(),i=r.left+r.width/2-12+"px",o=r.top+r.height/2-12+"px",r.height>window.innerHeight&&(o="50vh"),s=e.children[0],s.style.left=i,s.style.top=o,e.style.width=r.width+"px",e.style.height=r.height+"px",e.style.display="block"}}(this),setTimeout(t,0))},e.prototype.hideLoader=function(){return this.el.querySelector(".overlay").style.display="none"},e.prototype.update=function(){var t;return t=this.searchResults.getCurrent().get("facets"),1===this.searchResults.length?this.facets.renderFacets(t):this.searchResults.length>1?this.facets.update(t):void 0},e.prototype.destroy=function(){return null!=this.facets&&this.facets.destroy(),null!=this.textSearch&&this.textSearch.destroy(),null!=this.results&&this.results.destroy(),this.remove()},e.prototype.page=function(t,e){return this.searchResults.page(t,e)},e.prototype.next=function(){return this.searchResults.moveCursor("_next")},e.prototype.prev=function(){return this.searchResults.moveCursor("_prev")},e.prototype.hasNext=function(){return this.searchResults.getCurrent().has("_next")},e.prototype.hasPrev=function(){return this.searchResults.getCurrent().has("_prev")},e.prototype.sortResultsBy=function(t){var e,n,r,i;for(i=["id"],e=0,n=t.length;e<n;e++)r=t[e],""!==r.fieldname&&i.push(r.fieldname);return this.queryOptions.set({sortParameters:t,resultFields:i})},e.prototype.reset=function(t){return null==t&&(t=!1),null!=this.textSearch&&this.textSearch.reset(),null!=this.results&&this.results.reset(),this.facets.reset(),this.queryOptions.reset(),t||this.searchResults.clearCache(),this.search({cache:t})},e.prototype.refresh=function(t){return null==t&&(t={}),Object.keys(t).length>0&&this.queryOptions.set(t,{silent:!0}),this.search({cache:!1})},e.prototype.search=function(t){var e;return e=this.queryOptions.attributes,null===e.caseSensitive&&delete e.caseSensitive,this.searchResults.runQuery(e,t)},e.prototype.searchValue=function(t,e){var n,r,i,o,a,c;if("string"==typeof e&&(e=[e]),n=this.facets.views.hasOwnProperty(t),n&&(o=this.facets.views[t]instanceof l,i=this.facets.views[t]instanceof s),!n)throw"The facets view doesn't have a \""+t+'"';if(!o&&!i)throw'"facetName" is not an instance of ListFacet or BooleanFacet';for(this.reset(!0),this.facets.views[t].collection.revert(),r=0,a=e.length;r<a;r++)c=e[r],this.facets.views[t].collection.get(c).set({checked:!0,visible:!0});return this.queryOptions.reset(),this.refresh({facetValues:[{name:t,values:e}]})},e.prototype.currentResult=function(){return this.searchResults.getCurrent()},e}(i.View),e.exports=c},{"../jade/main.jade":46,"./collections/searchresults":12,"./models/config":14,"./models/query-options":17,"./views/facets":20,"./views/facets/boolean":21,"./views/facets/list":23,"./views/results":36,"./views/text-search":42,assert:1,backbone:void 0,"funcky.el":3,jquery:void 0,underscore:void 0}],14:[function(t,e,n){var r,i,s,o=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=t("backbone"),s=t("underscore"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.defaults=function(){return{baseUrl:null,searchPath:null,resultRows:10,authorizationHeaderToken:null,queryOptions:{facetValues:[]},requestOptions:{},entryMetadataFields:[],levelDisplayNames:{},levels:[],initLevels:{},textSearch:"advanced",textSearchOptions:{caseSensitive:!1,fuzzy:!1},autoSearch:!0,facetDisplayNames:{},facetOrder:[],parsers:{},collapse:!1,results:!1,sortLevels:!0,showMetadata:!0,showPageNames:null,templates:{},templateData:{},labels:{fullTextSearchFields:"Search in",numFound:"Found",filterOptions:"Filter options",sortAlphabetically:"Sort alphabetically",sortNumerically:"Sort numerically"},termSingular:"entry",termPlural:"entries"}},e.prototype.handleFirstResponseModel=function(t){var e,n,r,i;return i=s.clone(this.get("textSearchOptions")),t.has("fullTextSearchFields")?i.fullTextSearchParameters=t.get("fullTextSearchFields"):(i.term="",this.has("textLayers")&&(i.textLayers=this.get("textLayers"))),this.set({textSearchOptions:i}),Object.keys(this.get("levelDisplayNames")).length>0?(n=this._createDisplayNameMapFromMap("levels",this.get("levelDisplayNames")),r=this._createLevelMapFromMap(t.get("sortableFields"),this.get("levelDisplayNames"))):Object.keys(this.get("facetDisplayNames")).length>0?(n=this._createDisplayNameMapFromMap("levels",this.get("facetDisplayNames")),r=this._createLevelMapFromMap(t.get("sortableFields"),this.get("facetDisplayNames"))):(n=this._createDisplayNameMapFromFacetData("levels",t.get("facets")),r=this._createLevelMapFromFacetData(t.get("sortableFields"),t.get("facets"))),e=Object.keys(this.get("facetDisplayNames")).length>0?this._createDisplayNameMapFromMap("entryMetadataFields",this.get("facetDisplayNames")):this._createDisplayNameMapFromFacetData("entryMetadataFields",t.get("facets")),this.set({entryMetadataFields:e}),this.set({levels:r}),this.set({initLevels:n})},e.prototype._createLevelMapFromMap=function(t,e){var n,r,i,s;for(s={},r=0,i=t.length;r<i;r++)n=t[r],e.hasOwnProperty(n)?s[n]=e[n]:console.warn("Sortable field "+n+" not found in map!");return s},e.prototype._createDisplayNameMapFromMap=function(t,e){var n,r,i,o,a,l;if(o={},a=s.clone(this.get(t)),a.length>0)for(n=r=0,i=a.length;r<i;n=++r)l=a[n],e.hasOwnProperty(l)&&(o[l]=e[l]);return o},e.prototype._createLevelMapFromFacetData=function(t,e){var n,r,i,s,o,a,l;for(l={},i=0,o=t.length;i<o;i++)for(r=t[i],s=0,a=e.length;s<a;s++)n=e[s],n.name===r&&(l[r]=n.title);return l},e.prototype._createDisplayNameMapFromFacetData=function(t,e){var n,r,i,o,a,l,c,u,h,p;if(u={},h=s.clone(this.get(t)),h.length>0)for(r=o=0,l=e.length;o<l;r=++o)for(n=e[r],i=a=0,c=h.length;a<c;i=++a)p=h[i],n.name===p&&(u[p]=n.title);return u},e}(r.Model),e.exports=i},{backbone:void 0,underscore:void 0}],15:[function(t,e,n){var r,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;i=t("./main"),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.set=function(t,n){return"options"===t?n=this.parseOptions(n):t.hasOwnProperty("options")&&(t.options=this.parseOptions(t.options)),e.__super__.set.call(this,t,n)},e.prototype.parseOptions=function(t){return 1===t.length&&t.push({name:(!JSON.parse(t[0].name)).toString(),count:0}),t},e}(i),e.exports=r},{"./main":16}],16:[function(t,e,n){var r,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;r=t("backbone"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.idAttribute="name",e.prototype.defaults=function(){return{name:null,title:null,type:null,options:null}},e}(r.Model),e.exports=i},{backbone:void 0}],17:[function(t,e,n){var r,i,s,o=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=t("backbone"),s=t("underscore"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.defaults=function(){return{facetValues:[],sortParameters:[]}},e.prototype.initialize=function(t){this.initialAttributes=t},e.prototype.set=function(t,n){var r;return null!=t.facetValue&&(r=s.reject(this.get("facetValues"),function(e){return e.name===t.facetValue.name}),null!=t.facetValue.values?t.facetValue.values.length>0&&r.push(t.facetValue):r.push(t.facetValue),t.facetValues=r,delete t.facetValue),e.__super__.set.call(this,t,n)},e.prototype.reset=function(){return this.clear({silent:!0}),this.set(this.defaults(),{silent:!0}),this.set(this.initialAttributes,{silent:!0})},e}(r.Model),e.exports=i},{backbone:void 0,underscore:void 0}],18:[function(t,e,n){var r,i,s,o=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=t("backbone"),s=t("underscore"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e}(r.Model),e.exports=i},{backbone:void 0,underscore:void 0}],19:[function(t,e,n){var r,i,s,o=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=t("backbone"),s=t("underscore"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.defaults=function(){return{_next:null,_prev:null,ids:[],numFound:null,results:[],rows:null,solrquery:"",sortableFields:[],start:null,facets:[]}},e}(r.Model),e.exports=i},{backbone:void 0,underscore:void 0}],20:[function(t,e,n){var r,i,s,o,a,l=function(t,e){return function(){return t.apply(e,arguments)}},c=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty;i=t("backbone"),o=t("underscore"),r=t("jquery"),a=t("assert"),s=function(e){function n(){return this._renderFacet=l(this._renderFacet,this),n.__super__.constructor.apply(this,arguments)}return c(n,e),n.prototype.className="facets",n.prototype.viewMap={BOOLEAN:t("./facets/boolean"),RANGE:t("./facets/range"),LIST:t("./facets/list")},n.prototype.views=null,n.prototype.initialize=function(t){return this.options=t,o.extend(this.viewMap,this.options.viewMap),this.views={},this.render()},n.prototype.render=function(){var t;return this.options.config.get("templates").hasOwnProperty("facets")&&(t=this.options.config.get("templates").facets,this.el.innerHTML=t()),this},n.prototype.renderFacets=function(t){var e,n,r,s,o,l,c,u,h,p,f,d;if(this._destroyFacets(),this.options.config.get("templates").hasOwnProperty("facets"))for(c=l=0,h=t.length;l<h;c=++l)n=t[c],this.viewMap.hasOwnProperty(n.type)&&(f=this.el.querySelector("."+n.name+"-placeholder"),null!=f&&f.parentNode.replaceChild(this._renderFacet(n).el,f));else{for(s=new i.Collection(t,{model:i.Model.extend({idAttribute:"name"})}),0===this.options.config.get("facetOrder").length&&this.options.config.set({facetOrder:s.pluck("name")}),o=document.createDocumentFragment(),d=this.options.config.get("facetOrder"),u=0,p=d.length;u<p;u++)r=d[u],a.ok(null!=s.get(r),'FacetedSearch :: config.facetOrder : Unknown facet name: "'+r+'"!'),e=s.get(r),this.viewMap.hasOwnProperty(e.get("type"))?o.appendChild(this._renderFacet(e.attributes).el):console.error("Unknown facetView",e.get("type"));this.el.innerHTML="",this.el.appendChild(o)}return this._postRenderFacets(),this},n.prototype._renderFacet=function(t){var e;return o.isString(t)&&(t=o.findWhere(this.searchResults.first().get("facets"),{name:t})),e=this.viewMap[t.type],this.views[t.name]=new e({attrs:t,config:this.options.config}),this.listenTo(this.views[t.name],"change",function(t){return function(e,n){return null==n&&(n={}),t.trigger("change",e,n)}}(this)),this.views[t.name]},n.prototype._postRenderFacets=function(){var t,e,n,r;e=this.views,n=[];for(t in e)r=e[t],this.options.config.get("collapse")&&r.collapse(),n.push(r.postRender());return n},n.prototype.update=function(t){var e,n,r,i,s,a;r=this.views,i=[];for(a in r)u.call(r,a)&&(s=r[a],e=o.findWhere(t,{name:a}),n=null!=e?e.options:[],i.push(s.update(n)));return i},n.prototype.reset=function(){var t,e,n,r;n=this.views,r=[];for(e in n)u.call(n,e)&&(t=n[e],"function"==typeof t.reset?r.push(t.reset()):r.push(void 0));return r},n.prototype._destroyFacets=function(){var t,e,n,r;this.stopListening(),t=this.views,e=[];for(r in t)u.call(t,r)&&(n=t[r],n.destroy(),e.push(delete this.views[r]));return e},n.prototype.destroy=function(){return this._destroyFacets(),this.remove()},n.prototype.toggle=function(t){var e,n,i,s;return t.preventDefault(),e=r(t.currentTarget).find("i.fa"),i=r(t.currentTarget).find("button span"),n=e.hasClass("fa-expand"),e.toggleClass("fa-compress"),e.toggleClass("fa-expand"),s=n?"Collapse":"Expand",i.text(s+" filters"),this.slideFacets(n)},n.prototype.slideFacets=function(t){var e,n,r;return null==t&&(t=!0),e=o.keys(this.views),n=0,(r=function(i){return function(){var s,o;if(o=e[n++],s=i.views[o],null!=s)return t?s.showBody(function(){return r()}):s.hideBody(function(){return r()})}}(this))()},n}(i.View),e.exports=s},{"./facets/boolean":21,"./facets/list":23,"./facets/range":32,assert:1,backbone:void 0,jquery:void 0,underscore:void 0}],21:[function(t,e,n){var r,i,s,o,a,l,c=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty;r=t("jquery"),a=t("underscore"),s={Boolean:t("../../models/facets/boolean")},o={Facet:t("./main")},l=t("../../../jade/facets/boolean.body.jade"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.className="facet boolean",e.prototype.initialize=function(t){var n;return this.options=t,e.__super__.initialize.apply(this,arguments),n=this.parseFacetData(this.options.attrs),this.model=new s.Boolean(n,{parse:!0}),this.listenTo(this.model,"change:options",this.render),this.render()},e.prototype.render=function(){var t;return e.__super__.render.apply(this,arguments),t=l(a.extend(this.model.attributes,{ucfirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}})),this.$(".body").html(t),this.$("header i.fa").remove(),this},e.prototype.events=function(){return a.extend({},e.__super__.events.apply(this,arguments),{"click i":"checkChanged","click label":"checkChanged"})},e.prototype.checkChanged=function(t){var e,n,i,s,o,l;for(e="LABEL"===t.currentTarget.tagName?this.$('i[data-value="'+t.currentTarget.getAttribute("data-value")+'"]'):r(t.currentTarget),e.toggleClass("fa-square-o"),e.toggleClass("fa-check-square-o"),l=e.attr("data-value"),o=this.model.get("options"),n=0,i=o.length;n<i;n++)s=o[n],s.name===l&&(s.checked=e.hasClass("fa-check-square-o"));return this.trigger("change",{facetValue:{name:this.model.get("name"),values:a.map(this.$("i.fa-check-square-o"),function(t){return t.getAttribute("data-value")})}})},e.prototype.update=function(t){var e;return e=this.parseFacetData({name:this.options.attrs.name,options:t}),this.model.set("options",e.options)},e.prototype.reset=function(){return this.render()},e}(o.Facet),e.exports=i},{"../../../jade/facets/boolean.body.jade":44,"../../models/facets/boolean":15,"./main":30,jquery:void 0,underscore:void 0}],22:[function(t,e,n){var r,i,s,o,a=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;r=t("backbone"),o=t("underscore"),i=t("../models/option.coffee"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=i,e.prototype.comparator=null,e.prototype.initialize=function(){return this.comparator=this.strategies.count_desc},e.prototype.revert=function(){return this.comparator=this.strategies.count_desc,this.each(function(t){return function(t){return t.set("checked",!1,{silent:!0})}}(this))},e.prototype.update=function(t){return null==t&&(t=[]),this.each(function(t){return function(t){return t.set("count",0,{silent:!0})}}(this)),o.each(t,function(t){return function(e){var n;return n=t.get(e.name),null!=n?n.set("count",e.count,{silent:!0}):(n=new i(e),t.add(n))}}(this)),this.sort()},e.prototype.strategies={alpha_asc:function(t){return+!t.get("visible")+(+!t.get("count")+t.get("name").toLowerCase())},alpha_desc:function(t){var e;return e=String.fromCharCode.apply(String,o.map(t.get("name").toLowerCase().split(""),function(t){return 65535-t.charCodeAt()})),+!t.get("visible")+(+!t.get("count")+e)},count_asc:function(t){var e,n;return n=t.get("visible")?0:10,n+=+!t.get("count"),e=0===t.get("count")?t.get("total"):t.get("count"),n-=1/e},count_desc:function(t){var e,n;return n=t.get("visible")?0:10,n+=+!t.get("count"),e=0===t.get("count")?t.get("total"):t.get("count"),n+=1/e}},e.prototype.orderBy=function(t,e){return null==e&&(e=!1),this.comparator=this.strategies[t],this.sort({silent:e})},e.prototype.setAllVisible=function(){return this.each(function(t){return t.set("visible",!0)}),this.sort()},e}(r.Collection),e.exports=s},{"../models/option.coffee":25,backbone:void 0,underscore:void 0}],23:[function(t,e,n){var r,i,s,o,a,l,c,u,h=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty;r=t("jquery"),c=t("underscore"),s=t("./models/list"),l=t("./collections/options"),i=t("../main"),a=t("./options"),u=t("./templates/menu.jade"),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.className="facet list",e.prototype.initialize=function(t){var n;return this.options=t,e.__super__.initialize.apply(this,arguments),this.resetActive=!1,this.model=new s(this.options.attrs,{parse:!0}),n=this.parseFacetData(this.options.attrs),this.collection=new l(n.options,{parse:!0}),this.render()},e.prototype.render=function(){var t;return e.__super__.render.apply(this,arguments),this.$("header .options").length>0&&(this.options.config.get("templates").hasOwnProperty("list.menu")&&(u=this.options.config.get("templates")["list.menu"]),t=u({model:this.model.attributes}),this.$("header .options").html(t)),this.optionsView=new a({collection:this.collection,facetName:this.model.get("name"),config:this.options.config}),this.$(".body").html(this.optionsView.el),this.listenTo(this.optionsView,"filter:finished",this.renderFilteredOptionCount),this.listenTo(this.optionsView,"change",function(t){return function(e){return t.trigger("change",e)}}(this)),this.collection.length<=3&&this.$("header i.openclose").hide(),this},e.prototype.postRender=function(){var t;if(t=this.el.querySelector(".body > .container"),t.scrollHeight>t.clientHeight)return this.$el.addClass("with-scrollbar")},e.prototype.renderFilteredOptionCount=function(){var t,e,n,r;return r=this.collection.filter(function(t){return t.get("visible")}),n=0<(e=r.length)&&e<51?"visible":"hidden",this.$('input[type="checkbox"][name="all"]').css("visibility",n),t=this.collection.filter(function(t){return t.get("visible")}),0===t.length||t.length===this.collection.length?this.$('header .options input[name="filter"]').addClass("nonefound"):this.$('header .options input[name="filter"]').removeClass("nonefound"),this.$("header small.optioncount").html(t.length+" of "+this.collection.length),this},e.prototype.events=function(){return c.extend({},e.__super__.events.apply(this,arguments),{'keyup input[name="filter"]':function(t){return this.optionsView.filterOptions(t.currentTarget.value)},'change header .options input[type="checkbox"][name="all"]':function(t){return this.optionsView.setCheckboxes(t)},"click header .menu svg.filter":"_toggleFilterMenu","click header .menu svg.alpha":"_changeOrder","click header .menu svg.count":"_changeOrder"})},e.prototype._toggleFilterMenu=function(t){var e,n;return n=this.$("header .options"),e=t.currentTarget,r(e).toggleClass("active"),n.slideToggle(150,function(t){return function(){var i;return i=n.find('input[name="filter"]'),r(e).hasClass("active")?(i.focus(),t.optionsView.appendOptions(!0),t.renderFilteredOptionCount()):(i.val(""),t.collection.setAllVisible())}}(this))},e.prototype._changeOrder=function(t){var e,n,i,s,o,a,l,c,u;if(this.$("svg.filter").is(".active")||this.optionsView.renderAll(),u=r(t.currentTarget).attr("class").indexOf("alphabetically")>-1?"alpha":"count",r(t.currentTarget).is(".active"))a=r(t.currentTarget).attr("class").indexOf("descending")>-1?"asc":"desc",r(t.currentTarget).is(".alpha")?r(this.el).find("svg.alpha").each(function(e){return function(e,n){return r(n).attr("class",r(n).attr("class").replace(" visible","")),n!==t.currentTarget?r(n).attr("class",r(n).attr("class")+" visible active"):r(n).attr("class",r(n).attr("class").replace(" active",""))}}(this)):r(t.currentTarget).is(".count")&&r(this.el).find("svg.count").each(function(e){return function(e,n){return r(n).attr("class",r(n).attr("class").replace(" visible","")),n!==t.currentTarget?r(n).attr("class",r(n).attr("class")+" visible active"):r(n).attr("class",r(n).attr("class").replace(" active",""))}}(this));else{for(a=r(t.currentTarget).attr("class").indexOf("descending")>-1?"desc":"asc",l=r(this.el).find("svg.count.active").toArray(),n=0,s=l.length;n<s;n++)e=l[n],r(e).attr("class",r(e).attr("class").replace(" active",""));for(c=r(this.el).find("svg.alpha.active").toArray(),i=0,o=c.length;i<o;i++)e=c[i],r(e).attr("class",r(e).attr("class").replace(" active",""));r(t.currentTarget).attr("class",r(t.currentTarget).attr("class")+" active")}return this.collection.orderBy(u+"_"+a)},e.prototype.update=function(t){var e;return this.resetActive?(e=this.parseFacetData({options:t,name:this.options.attrs.name}),this.collection.reset(e.options,{parse:!0}),this.resetActive=!1):this.collection.update(t)},e.prototype.reset=function(){if(this.resetActive=!0,null!=this.el.querySelector("svg.filter")&&r("svg.filter").is(".active"))return this._toggleFilterMenu()},e.prototype.revert=function(){return null!=this.el.querySelector("svg.filter")&&r("svg.filter").is(".active")&&this._toggleFilterMenu(),this.collection.revert(),this.collection.sort()},e}(i),e.exports=o},{"../main":30,"./collections/options":22,"./models/list":24,"./options":26,"./templates/menu.jade":28,jquery:void 0,underscore:void 0}],24:[function(t,e,n){var r,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;r=t("../../../../models/facets/main"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e}(r),e.exports=i},{"../../../../models/facets/main":16}],25:[function(t,e,n){var r,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;r=t("backbone"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.idAttribute="name",e.prototype.defaults=function(){return{name:"",displayName:null,count:0,total:0,checked:!1,visible:!1}},e.prototype.parse=function(t){return t.total=t.count,t},e}(r.Model),e.exports=i},{backbone:void 0}],26:[function(t,e,n){var r,i,s,o,a,l,c,u=function(t,e){return function(){return t.apply(e,arguments)}},h=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty;i=t("backbone"),r=t("jquery"),o=t("underscore"),l=t("funcky.util"),a=t("./templates/body.jade"),c=t("./templates/option.jade"),s=function(t){function e(){return this.triggerChange=u(this.triggerChange,this),e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.className="container",e.prototype.initialize=function(t){return this.config=t.config,this.facetName=t.facetName,this.listenTo(this.collection,"sort",function(t){return function(){return t.rerender()}}(this)),this.listenTo(this.collection,"reset",function(t){return function(){return t.collection.orderBy("count_desc",!0),t.render()}}(this)),this.config.get("templates").hasOwnProperty("list.option")&&(c=this.config.get("templates")["list.option"]),this.render()},e.prototype.render=function(){return this.showingCursor=0,this.showingIncrement=50,this.config.get("templates").hasOwnProperty("list.body")&&(a=this.config.get("templates")["list.body"]),this.$el.html(a({facetName:this.facetName})),this.appendOptions(),this},e.prototype.rerender=function(){var t,e,n,r;for(n="",t=0,e=this.collection.at(t),r=e.get("visible");r;)n+=c({option:e}),t+=1,e=this.collection.at(t),r=!(null==e||!e.get("visible"));return this.$("ul").html(n)},e.prototype.appendOptions=function(t){var e,n;if(null==t&&(t=!1),this.$("ul > li").length!==this.collection.length){for(t&&(this.showingIncrement=this.collection.length),n="";this.showingCursor<this.showingIncrement&&this.showingCursor<this.collection.length;)e=this.collection.at(this.showingCursor),e.set("visible",!0),n+=c({option:e}),this.showingCursor=this.showingCursor+1;return this.$("ul").append(n)}},e.prototype.renderAll=function(){return this.collection.setAllVisible()},e.prototype.events=function(){return{"click li":"checkChanged",scroll:"onScroll"}},e.prototype.onScroll=function(t){var e,n;if(this.showingCursor<this.collection.length&&(e=t.currentTarget,n=e.scrollTop/e.scrollHeight,n>this.showingCursor/2/this.collection.length))return this.showingIncrement+=this.showingIncrement,this.appendOptions()},e.prototype.checkChanged=function(t){var e,n;return e=r(t.currentTarget),n=e.attr("data-value"),e.toggleClass("checked"),this.collection.get(n).set("checked",e.hasClass("checked")),0!==this.$("li.checked").length&&this.config.get("autoSearch")?l.setResetTimeout(1e3,function(t){return function(){return t.triggerChange()}}(this)):this.triggerChange()},e.prototype.triggerChange=function(t){var e;return null==t&&(e=this.collection.filter(function(t){return t.get("checked")}),t=o.map(e,function(t){return t.get("name")})),this.trigger("change",{facetValue:{name:this.facetName,values:t}})},e.prototype.filterOptions=function(t){return this.collection.map(function(e){var n;return n=new RegExp(t,"i"),e.set("visible",n.test(e.id))}),this.collection.sort(),this.trigger("filter:finished")},e.prototype.setCheckboxes=function(t){var e,n,r,i,s;for(s=this.collection.filter(function(t){return t.get("visible")}),e=0,n=s.length;e<n;e++)r=s[e],r.set("checked",t.currentTarget.checked);return t.currentTarget.checked?(i=o.map(s,function(t){return t.get("name")}),this.triggerChange(i)):this.triggerChange()},e}(i.View),e.exports=s},{"./templates/body.jade":27,"./templates/option.jade":29,backbone:void 0,"funcky.util":5,jquery:void 0,underscore:void 0}],27:[function(t,e,n){t("jade/runtime");e.exports=function(t){var e=[];return e.push("<ul></ul>"),e.join("")}},{"jade/runtime":7}],28:[function(t,e,n){t("jade/runtime");e.exports=function(t){var e=[];return e.push('<input type="checkbox" name="all"/><input type="text" name="filter"/><small class="optioncount"></small>'),e.join("")}},{"jade/runtime":7}],29:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i={},s=t||{};return function(t){i["checked-icon"]=e=function(){this&&this.block,this&&this.attributes||{};n.push('<svg viewBox="0 0 489 402" class="checked"><path d="M 377.87,24.128 C 361.786,8.044 342.417,0.002 319.769,0.002 H 82.227 C 59.579,0.002 40.211,8.044 24.125,24.128 8.044,40.214 0.002,59.578 0.002,82.23 v 237.543 c 0,22.647 8.042,42.014 24.123,58.101 16.086,16.085 35.454,24.127 58.102,24.127 h 237.542 c 22.648,0 42.011,-8.042 58.102,-24.127 16.085,-16.087 24.126,-35.453 24.126,-58.101 V 82.23 C 401.993,59.582 393.951,40.214 377.87,24.128 z m -12.422,295.645 c 0,12.559 -4.47,23.314 -13.415,32.264 -8.945,8.945 -19.698,13.411 -32.265,13.411 H 82.227 c -12.563,0 -23.317,-4.466 -32.264,-13.411 -8.945,-8.949 -13.418,-19.705 -13.418,-32.264 V 82.23 c 0,-12.562 4.473,-23.316 13.418,-32.264 C 58.91,41.02 69.664,36.548 82.227,36.548 h 237.542 c 12.566,0 23.319,4.473 32.265,13.418 8.945,8.947 13.415,19.701 13.415,32.264 v 237.543 l -0.001,0 z"></path><path d="M 480.59183,75.709029 442.06274,38.831006 c -5.28301,-5.060423 -11.70817,-7.591583 -19.26056,-7.591583 -7.55937,0 -13.98453,2.53116 -19.26753,7.591583 L 217.6825,216.98773 134.38968,136.99258 c -5.28896,-5.06231 -11.71015,-7.59062 -19.26256,-7.59062 -7.55736,0 -13.97854,2.52831 -19.267516,7.59062 l -38.529082,36.87898 c -5.28897,5.06136 -7.932461,11.20929 -7.932461,18.44186 0,7.22686 2.643491,13.38049 7.932461,18.4409 l 102.555358,98.15873 38.53207,36.87803 c 5.28598,5.06421 11.70916,7.59253 19.26455,7.59253 7.5524,0 13.97558,-2.53496 19.26454,-7.59253 l 38.53107,-36.87803 205.11372,-196.32314 c 5.284,-5.06232 7.93246,-11.20929 7.93246,-18.441873 0.005,-7.228765 -2.64846,-13.376685 -7.93246,-18.439008 z"></path></svg>');
},i["unchecked-icon"]=e=function(){this&&this.block,this&&this.attributes||{};n.push('<svg viewBox="0 0 401.998 401.998" class="unchecked"><path d="M377.87,24.126C361.786,8.042,342.417,0,319.769,0H82.227C59.579,0,40.211,8.042,24.125,24.126 C8.044,40.212,0.002,59.576,0.002,82.228v237.543c0,22.647,8.042,42.014,24.123,58.101c16.086,16.085,35.454,24.127,58.102,24.127 h237.542c22.648,0,42.011-8.042,58.102-24.127c16.085-16.087,24.126-35.453,24.126-58.101V82.228 C401.993,59.58,393.951,40.212,377.87,24.126z M365.448,319.771c0,12.559-4.47,23.314-13.415,32.264 c-8.945,8.945-19.698,13.411-32.265,13.411H82.227c-12.563,0-23.317-4.466-32.264-13.411c-8.945-8.949-13.418-19.705-13.418-32.264 V82.228c0-12.562,4.473-23.316,13.418-32.264c8.947-8.946,19.701-13.418,32.264-13.418h237.542 c12.566,0,23.319,4.473,32.265,13.418c8.945,8.947,13.415,19.701,13.415,32.264V319.771L365.448,319.771z"></path></svg>')};var s=t.id,o=["",":empty","(empty)"];o.indexOf(t.id)>-1&&(s="<em>(empty)</em>"),null!=t.get("displayName")&&(s=t.get("displayName")),n.push("<li"+r.attr("data-count",t.get("count"),!0,!1)+r.attr("data-value",t.id,!0,!1)+r.cls([t.get("checked")?"checked":null],[!0])+">"),i["unchecked-icon"](),i["checked-icon"](),n.push("<label"+r.attr("data-value",t.id,!0,!1)+">"+(null==(e=s)?"":e)+'</label><div class="count">'+r.escape(null==(e=0===t.get("count")?t.get("total"):t.get("count"))?"":e)+"</div></li>")}.call(this,"option"in s?s.option:"undefined"!=typeof option?option:void 0),n.join("")}},{"jade/runtime":7}],30:[function(t,e,n){var r,i,s,o,a,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;i=t("backbone"),r=t("jquery"),o=t("underscore"),a=t("../../../jade/facets/main.jade"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.initialize=function(t){if(this.config=t.config,this.config.get("facetDisplayNames").hasOwnProperty(t.attrs.name))return t.attrs.title=this.config.get("facetDisplayNames")[t.attrs.name]},e.prototype.render=function(){return this.config.get("templates").hasOwnProperty("facets.main")&&(a=this.config.get("templates")["facets.main"]),this.$el.html(a({model:this.model,config:this.config})),this.$el.attr("data-name",this.model.get("name")),this},e.prototype.events=function(){return{"click h3":"_toggleBody"}},e.prototype.update=function(t){},e.prototype.reset=function(){},e.prototype.postRender=function(){},e.prototype.parseFacetData=function(t){var e;return e=this.options.config.get("parsers"),e.hasOwnProperty(t.name)&&(t=e[t.name](t)),t},e.prototype._toggleBody=function(t){var e;return e=this.$(".body").is(":visible")?this.hideBody:this.showBody,o.isFunction(t)?e.call(this,t):e.call(this)},e.prototype._hideMenu=function(){var t;return t=this.$("header i.openclose"),t.addClass("fa-plus-square-o"),t.removeClass("fa-minus-square-o"),this.$("header .options").slideUp(150)},e.prototype.collapse=function(){return this._hideMenu(),this.$("header i.fa").hide(),this.$(".body").hide()},e.prototype.hideBody=function(t){return this._hideMenu(),this.$(".body").slideUp(100,function(e){return function(){return null!=t&&t(),e.$("header > .menu").fadeOut(100)}}(this))},e.prototype.showBody=function(t){return this.$(".body").slideDown(100,function(e){return function(){return null!=t&&t(),e.$("header > .menu").fadeIn(100)}}(this))},e.prototype.destroy=function(){return this.remove()},e}(i.View),e.exports=s},{"../../../jade/facets/main.jade":45,backbone:void 0,jquery:void 0,underscore:void 0}],31:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i=t||{};return function(t,i){n.push('<div class="slider"><span class="dash">-</span><div class="handle-min handle"><input'+r.attr("value",i,!0,!1)+' class="min"/><label class="min">'+r.escape(null==(e=i)?"":e)+'</label></div><div class="handle-max handle"><input'+r.attr("value",t,!0,!1)+' class="max"/><label class="max">'+r.escape(null==(e=t)?"":e)+'</label></div><div class="bar">&nbsp;</div><button title="Search within given range"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 216 146" xml:space="preserve"><path d="M172.77,123.025L144.825,95.08c6.735-9.722,10.104-20.559,10.104-32.508c0-7.767-1.508-15.195-4.523-22.283c-3.014-7.089-7.088-13.199-12.221-18.332s-11.242-9.207-18.33-12.221c-7.09-3.015-14.518-4.522-22.285-4.522c-7.767,0-15.195,1.507-22.283,4.522c-7.089,3.014-13.199,7.088-18.332,12.221c-5.133,5.133-9.207,11.244-12.221,18.332c-3.015,7.089-4.522,14.516-4.522,22.283c0,7.767,1.507,15.193,4.522,22.283c3.014,7.088,7.088,13.197,12.221,18.33c5.133,5.134,11.244,9.207,18.332,12.222c7.089,3.015,14.516,4.522,22.283,4.522c11.951,0,22.787-3.369,32.509-10.104l27.945,27.863c1.955,2.064,4.397,3.096,7.332,3.096c2.824,0,5.27-1.032,7.332-3.096c2.064-2.063,3.096-4.508,3.096-7.332C175.785,127.479,174.781,125.034,172.77,123.025z M123.357,88.357c-7.143,7.143-15.738,10.714-25.787,10.714c-10.048,0-18.643-3.572-25.786-10.714c-7.143-7.143-10.714-15.737-10.714-25.786c0-10.048,3.572-18.644,10.714-25.786c7.142-7.143,15.738-10.714,25.786-10.714c10.048,0,18.643,3.572,25.787,10.714c7.143,7.142,10.715,15.738,10.715,25.786C134.072,72.62,130.499,81.214,123.357,88.357z"></path></svg></button></div>')}.call(this,"max"in i?i.max:"undefined"!=typeof max?max:void 0,"min"in i?i.min:"undefined"!=typeof min?min:void 0),n.join("")}},{"jade/runtime":7}],32:[function(t,e,n){var r,i,s,o,a,l,c,u,h=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},p={}.hasOwnProperty;r=t("jquery"),l=t("underscore"),o=t("./model"),s=t("./month-model"),i=t("../main"),c=t("./body.jade"),u=t("./month-body.jade"),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.className="facet range",e.prototype.draggingMin=!1,e.prototype.draggingMax=!1,e.prototype.model=null,e.prototype.initialize=function(t){return this.options=t,e.__super__.initialize.apply(this,arguments),this.options.config.get("rangeMonthMode")?this.model=new s(this.options.attrs,{parse:!0}):this.model=new o(this.options.attrs,{parse:!0}),this.listenTo(this.model,"change:options",this.render),this.listenTo(this.model,"change",function(t){return function(e){if((e.changed.hasOwnProperty("currentMin")||e.changed.hasOwnProperty("currentMax"))&&null!=t.button&&t.options.config.get("autoSearch"))return t.button.style.display="block"}}(this)),this.listenTo(this.model,"change:handleMinLeft",function(t){return function(e,n){return t.handleMin.css("left",n),t.bar.css("left",n+t.model.get("handleWidth")/2)}}(this)),this.listenTo(this.model,"change:handleMaxLeft",function(t){return function(e,n){return t.handleMax.css("left",n),t.bar.css("right",e.get("sliderWidth")-n-t.model.get("handleWidth")/2)}}(this)),this.listenTo(this.model,"change:currentMin",function(t){return function(e,n){if(t.labelMin.html(Math.ceil(n)),t.options.config.get("rangeMonthMode"))return t.labelMonthMin.html(t.model.getMonthLabel(n,!0))}}(this)),this.listenTo(this.model,"change:currentMax",function(t){return function(e,n){if(t.labelMax.html(Math.ceil(n)),t.options.config.get("rangeMonthMode"))return t.labelMonthMax.html(t.model.getMonthLabel(n,!0))}}(this)),this.render()},e.prototype.render=function(){var t;return e.__super__.render.apply(this,arguments),this.options.config.get("templates").hasOwnProperty("range.body")&&(c=this.options.config.get("templates")["range.body"]),t=this.options.config.get("rangeMonthMode")?u(this.model.attributes):c(this.model.attributes),this.$(".body").html(t),this.$("header .menu").hide(),this.dragStopper=this.stopDragging.bind(this),this.$el.on("mouseleave",this.dragStopper),this.resizer=this.onResize.bind(this),window.addEventListener("resize",this.resizer),this},e.prototype.postRender=function(){var t;if(this.handleMin=this.$(".handle-min"),this.handleMax=this.$(".handle-max"),this.labelMin=this.$("label.min"),this.labelMax=this.$("label.max"),this.options.config.get("rangeMonthMode")&&(this.labelMonthMin=this.$("label.month-min"),this.labelMonthMax=this.$("label.month-max"),this.labelMonthMin.html(this.model.getMonthLabel(this.model.get("currentMin"))),this.labelMonthMax.html(this.model.getMonthLabel(this.model.get("currentMax")))),this.bar=this.$(".bar"),this.button=this.el.querySelector("button"),this.options.config.get("rangeFacetAlwaysShowButton")&&(this.button.style.display="block"),t=this.$(".slider"),0!==t.width())return this.model.set({sliderWidth:t.width(),sliderLeft:t.offset().left,handleMinLeft:this.handleMin.position().left,handleMaxLeft:this.handleMax.position().left,handleWidth:this.handleMin.width()})},e.prototype.events=function(){return l.extend({},e.__super__.events.apply(this,arguments),{"mousedown .handle":"startDragging","mousedown .bar":"startDragging",mouseup:"stopDragging",mousemove:"drag","blur input":"setYear","keyup input":"setYear","click button":"doSearch","dblclick label.min":function(t){return this.enableInputEditable(this.labelMin)},"dblclick label.max":function(t){return this.enableInputEditable(this.labelMax)},"dblclick label.month-min":function(t){return this.enableInputEditable(this.labelMonthMin)},"dblclick label.month-max":function(t){return this.enableInputEditable(this.labelMonthMax)}})},e.prototype.setYear=function(t){if("focusout"===t.type||"blur"===t.type||"keyup"===t.type&&13===t.keyCode){if(t.currentTarget.className.indexOf("month-min")>-1)return this.model.setFromLabel({currentMin:t.currentTarget.value}),this.disableInputEditable(this.labelMonthMin);if(t.currentTarget.className.indexOf("month-max")>-1)return this.model.setFromLabel({currentMax:t.currentTarget.value}),this.disableInputEditable(this.labelMonthMax);if(t.currentTarget.className.indexOf("min")>-1)return this.model.set({currentMin:+t.currentTarget.value}),this.disableInputEditable(this.labelMin);if(t.currentTarget.className.indexOf("max")>-1)return this.model.set({currentMax:+t.currentTarget.value}),this.disableInputEditable(this.labelMax)}},e.prototype.doSearch=function(t){return t.preventDefault(),this.triggerChange()},e.prototype.startDragging=function(t){var e,n;if(n=r(t.currentTarget),e=n.find("input"),!(e.length>0&&e.hasClass("edit")))return n.hasClass("handle-min")?(this.draggingMin=!0,this.handleMax.css("z-index",10),n.css("z-index",11)):n.hasClass("handle-max")?(this.draggingMax=!0,this.handleMin.css("z-index",10),n.css("z-index",11)):n.hasClass("bar")?this.draggingBar={offsetLeft:t.clientX-this.model.get("sliderLeft")-this.model.get("handleMinLeft"),barWidth:this.bar.width()}:void 0},e.prototype.drag=function(t){var e,n,r;if(n=t.clientX-this.model.get("sliderLeft"),(this.draggingMin||this.draggingMax)&&(this.disableInputOverlap(),this.checkInputOverlap()),null!=this.draggingBar&&(this.updateDash(),e=n-this.draggingBar.offsetLeft,r=e+this.draggingBar.barWidth,-1<e&&r<=this.model.get("sliderWidth")&&(this.model.dragMin(e),this.model.dragMax(r))),this.draggingMin&&this.model.dragMin(n-this.model.get("handleWidth")/2),this.draggingMax)return this.model.dragMax(n-this.model.get("handleWidth")/2)},e.prototype.stopDragging=function(t){if((this.draggingMin||this.draggingMax||null!=this.draggingBar)&&(this.draggingMin&&this.model.get("currentMin")!==+this.labelMin.html()&&this.model.set({currentMin:+this.labelMin.html()}),this.draggingMax&&this.model.get("currentMax")!==+this.labelMax.html()&&this.model.set({currentMax:+this.labelMax.html()}),this.draggingMin=!1,this.draggingMax=!1,this.draggingBar=null,!this.options.config.get("autoSearch")))return this.triggerChange({silent:!0})},e.prototype.enableInputEditable=function(t){var e,n;return e=t.closest(".handle"),n=e.find("input"),n.addClass(t.attr("class")),e.addClass("edit"),n.focus().val(t.html())},e.prototype.disableInputEditable=function(t){var e;return e=t.closest(".handle"),e.removeClass("edit")},e.prototype.destroy=function(){return this.$el.off("mouseleave",this.dragStopper),window.removeEventListener("resize",this.resizer),this.remove()},e.prototype.triggerChange=function(t){var e,n;return null==t&&(t={}),e=this.model.get("name"),null!=this.options.config.get("customQueryNames")&&this.options.config.get("customQueryNames")[e]&&(e=this.options.config.get("customQueryNames")[e]),n={facetValue:{name:e,lowerLimit:this.model.getLowerLimit(),upperLimit:this.model.getUpperLimit()}},this.trigger("change",n,t)},e.prototype.onResize=function(){return this.postRender(),this.update([{lowerLimit:this.model.get("currentMin"),upperLimit:this.model.get("currentMax")}]),this.checkInputOverlap()},e.prototype.checkInputOverlap=function(){var t,e,n;return n=this.labelMin[0].getBoundingClientRect(),e=this.labelMax[0].getBoundingClientRect(),n.right<e.left||n.left>e.right||n.bottom<e.top||n.top>e.bottom?this.disableInputOverlap():(t=n.right-e.left,this.enableInputOverlap(t))},e.prototype.enableInputOverlap=function(t){return this.labelMin.css("left",-20-t/2),this.labelMax.css("right",-20-t/2),this.updateDash(),this.$(".dash").show(),this.labelMin.addClass("overlap"),this.labelMax.addClass("overlap")},e.prototype.disableInputOverlap=function(){return this.labelMin.css("left",-20),this.labelMax.css("right",-20),this.$(".dash").hide(),this.labelMin.removeClass("overlap"),this.labelMax.removeClass("overlap")},e.prototype.updateDash=function(){return this.$(".dash").css("left",this.model.get("handleMinLeft")+(this.model.get("handleMaxLeft")-this.model.get("handleMinLeft"))/2+3)},e.prototype.update=function(t){var e,n;if(l.isArray(t)?null!=t[0]&&(t=t[0],t.lowerLimit<2500?(e=t.lowerLimit,n=t.upperLimit):(e=this.model.convertLimit2Year(t.lowerLimit),n=this.model.convertLimit2Year(t.upperLimit)),this.model.set({currentMin:e,currentMax:n})):this.model.reset(),null!=this.button&&!this.options.config.get("rangeFacetAlwaysShowButton"))return this.button.style.display="none"},e.prototype.showBody=function(t){var n;return n=function(e){return function(){if(e.model.has("sliderWidth")&&0!==e.model.get("sliderWidth")||e.postRender(),null!=t)return t()}}(this),e.__super__.showBody.call(this,n)},e}(i),e.exports=a},{"../main":30,"./body.jade":31,"./model":33,"./month-body.jade":34,"./month-model":35,jquery:void 0,underscore:void 0}],33:[function(t,e,n){var r,i,s,o=function(t,e){return function(){return t.apply(e,arguments)}},a=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l={}.hasOwnProperty;s=t("underscore"),r=t("../../../models/facets/main"),i=function(t){function e(){return this.dragMax=o(this.dragMax,this),this.dragMin=o(this.dragMin,this),e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults=function(){return s.extend({},e.__super__.defaults.apply(this,arguments),{min:null,max:null,currentMin:null,currentMax:null,handleMinLeft:null,handleMaxLeft:null,sliderWidth:null,lowerLimit:null,upperLimit:null})},e.prototype.initialize=function(){return this.once("change",function(t){return function(){return t.on("change:currentMin",function(e,n){return t.set({handleMinLeft:t.getLeftFromYear(n)})}),t.on("change:currentMax",function(e,n){return t.set({handleMaxLeft:t.getLeftFromYear(n)})}),t.on("change:handleMinLeft",function(e,n){return t.set({currentMin:t.getYearFromLeft(n)})}),t.on("change:handleMaxLeft",function(e,n){return t.set({currentMax:t.getYearFromLeft(n)})})}}(this))},e.prototype.set=function(t,n){return t.hasOwnProperty("currentMin")&&t.currentMin>this.get("currentMax")&&(t.currentMax=+t.currentMin,t.currentMin=this.get("currentMax")),t.hasOwnProperty("currentMax")&&t.currentMax<this.get("currentMin")&&(t.currentMin=+t.currentMax,t.currentMax=this.get("currentMin")),t.hasOwnProperty("currentMin")&&this.has("min")&&t.currentMin<this.get("min")&&(t.currentMin=this.get("min")),t.hasOwnProperty("currentMax")&&this.has("max")&&t.currentMax>this.get("max")&&(t.currentMax=this.get("max")),e.__super__.set.apply(this,arguments)},e.prototype.parse=function(t){return e.__super__.parse.apply(this,arguments),t.lowerLimit=t.options[0].lowerLimit,t.upperLimit=t.options[0].upperLimit,t.min=t.currentMin=this.convertLimit2Year(t.lowerLimit),t.max=t.currentMax=this.convertLimit2Year(t.upperLimit),delete t.options,t},e.prototype.convertLimit2Year=function(t){var e;if(e=t+"",0===e.length&&(e="0"),e.length>4)if(8===e.length)e=e.substr(0,4);else{if(7!==e.length)throw new Error("Range: lower or upper limit is not 0, 1, 2, 3, 4, 7 or 8 chars!");e=e.substr(0,3)}return+e},e.prototype._convertYear2Limit=function(t,e){var n;return null==e&&(e=!0),n=t+"",n+=e?"0101":"1231",+n},e.prototype.getLowerLimit=function(){var t;return t=this.get("currentMin"),(this.get("lowerLimit")+"").length>4&&(t=this._convertYear2Limit(this.get("currentMin"))),t},e.prototype.getUpperLimit=function(){var t;return t=this.get("currentMax"),(this.get("lowerLimit")+"").length>4&&(t=this._convertYear2Limit(this.get("currentMax"),!1)),t},e.prototype.reset=function(){return this.set({currentMin:this.get("min"),currentMax:this.get("max"),lowerLimit:this.get("min"),upperLimit:this.get("max")})},e.prototype.getLeftFromYear=function(t){var e,n,r,i;return n=this.get("min"),i=this.get("max"),r=this.get("sliderWidth"),e=this.get("handleWidth")/2,(t-n)/(i-n)*r-e},e.prototype.getYearFromLeft=function(t){var e,n,r,i;return n=this.get("min"),i=this.get("max"),e=this.get("handleWidth")/2,r=this.get("sliderWidth"),Math.round((t+e)/r*(i-n)+n)},e.prototype.dragMin=function(t){var e;if(e=this.get("handleWidth")/2,-e<=t&&t<=this.get("handleMaxLeft"))return this.set({handleMinLeft:t})},e.prototype.dragMax=function(t){if(this.get("handleMinLeft")<t&&t<=this.get("sliderWidth")-this.get("handleWidth")/2)return this.set({handleMaxLeft:t})},e}(r),e.exports=i},{"../../../models/facets/main":16,underscore:void 0}],34:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i=t||{};return function(t,i,s,o){n.push('<div class="slider"><span class="dash">-</span><div class="handle-min handle"><input'+r.attr("value",i,!0,!1)+' class="min"/><label class="min hidden">'+r.escape(null==(e=i)?"":e)+'</label><label class="month-min">'+r.escape(null==(e=o)?"":e)+'</label></div><div class="handle-max handle"><input'+r.attr("value",t,!0,!1)+' class="max"/><label class="max hidden">'+r.escape(null==(e=t)?"":e)+'</label><label class="month-max">'+r.escape(null==(e=s)?"":e)+'</label></div><div class="bar">&nbsp;</div><button title="Search within given range"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 216 146" xml:space="preserve"><path d="M172.77,123.025L144.825,95.08c6.735-9.722,10.104-20.559,10.104-32.508c0-7.767-1.508-15.195-4.523-22.283c-3.014-7.089-7.088-13.199-12.221-18.332s-11.242-9.207-18.33-12.221c-7.09-3.015-14.518-4.522-22.285-4.522c-7.767,0-15.195,1.507-22.283,4.522c-7.089,3.014-13.199,7.088-18.332,12.221c-5.133,5.133-9.207,11.244-12.221,18.332c-3.015,7.089-4.522,14.516-4.522,22.283c0,7.767,1.507,15.193,4.522,22.283c3.014,7.088,7.088,13.197,12.221,18.33c5.133,5.134,11.244,9.207,18.332,12.222c7.089,3.015,14.516,4.522,22.283,4.522c11.951,0,22.787-3.369,32.509-10.104l27.945,27.863c1.955,2.064,4.397,3.096,7.332,3.096c2.824,0,5.27-1.032,7.332-3.096c2.064-2.063,3.096-4.508,3.096-7.332C175.785,127.479,174.781,125.034,172.77,123.025z M123.357,88.357c-7.143,7.143-15.738,10.714-25.787,10.714c-10.048,0-18.643-3.572-25.786-10.714c-7.143-7.143-10.714-15.737-10.714-25.786c0-10.048,3.572-18.644,10.714-25.786c7.142-7.143,15.738-10.714,25.786-10.714c10.048,0,18.643,3.572,25.787,10.714c7.143,7.142,10.715,15.738,10.715,25.786C134.072,72.62,130.499,81.214,123.357,88.357z"></path></svg></button></div>')}.call(this,"max"in i?i.max:"undefined"!=typeof max?max:void 0,"min"in i?i.min:"undefined"!=typeof min?min:void 0,"monthMax"in i?i.monthMax:"undefined"!=typeof monthMax?monthMax:void 0,"monthMin"in i?i.monthMin:"undefined"!=typeof monthMin?monthMin:void 0),n.join("")}},{"jade/runtime":7}],35:[function(t,e,n){var r,i,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},o={}.hasOwnProperty;i=t("./model"),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.convertLimit2Year=function(t){var e;if(e=t+"",0===e.length&&(e="0"),e.length>6)if(8===e.length)e=e.substr(0,6);else{if(7!==e.length)throw new Error("Range: lower or upper limit is not 0, 1, 2, 3, 4, 7 or 8 chars!");e=e.substr(0,5)}return+e},e.prototype._convertYear2Limit=function(t,e){var n;return null==e&&(e=!0),n=t+"",n+=e?"01":"31",+n},e.prototype.getLowerLimit=function(){var t,e;return e=this.get("currentMin"),t=""+(parseInt(parseInt((""+e).substr(4,2))/100*12)+1),1===t.length&&(t="0"+t),parseInt((""+e).substr(0,4)+t+"01")},e.prototype.getUpperLimit=function(){var t,e;return e=this.get("currentMax"),t=""+(parseInt(parseInt((""+e).substr(4,2))/100*12)+1),1===t.length&&(t="0"+t),parseInt((""+e).substr(0,4)+t+"31")},e.prototype.setFromLabel=function(t){var e,n,r,i;return n="currentMin",t.hasOwnProperty("currentMax")&&(n="currentMax"),i=t[n].match(/^[0-9]{4}-[0-9]{2}$/),null!=i?(e=t[n].split("-"),r=Math.ceil((+e[1]-1)/12*100),"currentMin"===n?this.set({currentMin:100*+e[0]+r}):this.set({currentMax:100*+e[0]+r})):"currentMin"===n?this.set({currentMin:this.get("min")}):this.set({currentMax:this.get("max")})},e.prototype.getMonthLabel=function(t,e){var n;return n=e?""+(parseInt(parseInt((""+t).substr(4,2))/100*12)+1):(""+t).substr(4,2),1===n.length&&(n="0"+n),(""+t).substr(0,4)+"-"+n},e}(i),e.exports=r},{"./model":33}],36:[function(t,e,n){var r,i,s,o,a,l,c,u,h,p=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f={}.hasOwnProperty;i=t("backbone"),r=t("jquery"),c=t("underscore"),o=t("./result"),l=t("./sort"),s=t("hibb-pagination"),h=t("./index.jade"),u=[],a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.isMetadataVisible=!0,e.prototype.resultItems=null,e.prototype.subviews=null,e.prototype.initialize=function(t){return this.options=t,this.subviews={},this.resultItems=[],this.listenTo(this.options.searchResults,"change:page",this._renderResultsPage),this.listenTo(this.options.searchResults,"change:results",function(t){return function(e){return t.$("header h3.numfound").html(t.options.config.get("labels").numFound+" "+e.get("numFound")+" "+t.options.config.get("termPlural")),t.renderPagination(e),t._renderResultsPage(e)}}(this)),this.render()},e.prototype.render=function(){return this.$el.html(h({showMetadata:this.options.config.get("showMetadata"),resultsPerPage:this.options.config.get("resultRows"),config:this.options.config})),this._renderSorting(),r(window).resize(function(t){return function(){var e;return e=t.$("div.pages"),e.height(r(window).height()-e.offset().top)}}(this)),this},e.prototype._renderSorting=function(){if(this.options.config.get("sortLevels"))return null!=this.subviews.sortLevels&&this.subviews.sortLevels.destroy(),this.subviews.sortLevels=new l({config:this.options.config}),this.$("header nav ul").prepend(this.subviews.sortLevels.$el),this.listenTo(this.subviews.sortLevels,"change",function(t){return function(e){return t.trigger("change:sort-levels",e)}}(this))},e.prototype._renderResultsPage=function(t){var e,n,i,s,a,l,c,u;for(this._destroyResultItems(),this.$("div.pages").html(""),n=!1,t.get("results").length>0&&null!=t.get("results")[0].terms&&Object.keys(t.get("results")[0].terms).length>0&&(n=!0),e=document.createDocumentFragment(),l=t.get("results"),i=0,s=l.length;i<s;i++)c=l[i],c=new o({data:c,fulltext:n,config:this.options.config}),this.resultItems.push(c),this.listenTo(c,"click",function(t){return this.trigger("result:click",t)}),this.listenTo(c,"layer:click",function(t,e){return this.trigger("result:layer-click",t,e)}),e.appendChild(c.el);return a=this.subviews.pagination.getCurrentPageNumber(),u=r('<ul class="page" data-page-number="'+a+'" />'),u.html(e),this.$("div.pages").append(u),this.trigger("render:finished")},e.prototype.renderPagination=function(t){return null!=this.subviews.pagination&&(this.stopListening(this.subviews.pagination),this.subviews.pagination.destroy()),this.subviews.pagination=new s({resultsStart:t.get("start"),resultsPerPage:this.options.config.get("resultRows"),resultsTotal:t.get("numFound"),showPageNames:this.options.config.get("showPageNames")}),this.listenTo(this.subviews.pagination,"change:pagenumber",this.changePage),this.$("header .pagination").html(this.subviews.pagination.el)},e.prototype.changePage=function(t){var e,n;return n=this.$("div.pages"),n.find("ul.page").hide(),e=n.find('ul.page[data-page-number="'+t+'"]'),e.length>0?e.show():this.options.searchResults.page(t)},e.prototype.events=function(){return{"change li.show-metadata input":"showMetadata","change li.results-per-page select":"onChangeResultsPerPage"}},e.prototype.onChangeResultsPerPage=function(t){var e;return e=t.currentTarget,this.options.config.set("resultRows",e.options[e.selectedIndex].value)},e.prototype.showMetadata=function(t){return this.isMetadataVisible=t.currentTarget.checked,this.$(".metadata").toggle(this.isMetadataVisible)},e.prototype.reset=function(){return this._renderSorting()},e.prototype.destroy=function(){return this._destroyResultItems(),this.subviews.sortLevels.destroy()},e.prototype._destroyResultItems=function(){var t,e,n,r,i;for(r=this.resultItems,i=[],t=0,n=r.length;t<n;t++)e=r[t],i.push(e.destroy());return i},e}(i.View),e.exports=a},{"./index.jade":37,"./result":38,"./sort":40,backbone:void 0,"hibb-pagination":6,jquery:void 0,underscore:void 0}],37:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i=t||{};return function(t,i,s,o){n.push('<header><h3 class="numfound"></h3><nav><ul><li class="results-per-page"><select name="results-per-page">'),function(){var s=[10,25,50,100,250,500,1e3];if("number"==typeof s.length)for(var o=0,a=s.length;o<a;o++){var l=s[o];n.push("<option"+r.attr("value",l,!0,!1)+r.attr("selected",l===i,!0,!1)+">"+r.escape(null==(e=l+" "+t.get("termPlural"))?"":e)+"</option>")}else{var a=0;for(var o in s){a++;var l=s[o];n.push("<option"+r.attr("value",l,!0,!1)+r.attr("selected",l===i,!0,!1)+">"+r.escape(null==(e=l+" "+t.get("termPlural"))?"":e)+"</option>")}}}.call(this),n.push("</select></li>"),s&&n.push('<li class="show-metadata"><input id="o45hes3" type="checkbox" checked="checked"/><label for="o45hes3">Show metadata</label></li>'),n.push('</ul></nav><div class="pagination"></div></header><div class="pages"></div>')}.call(this,"config"in i?i.config:"undefined"!=typeof config?config:void 0,"resultsPerPage"in i?i.resultsPerPage:"undefined"!=typeof resultsPerPage?resultsPerPage:void 0,"showMetadata"in i?i.showMetadata:"undefined"!=typeof showMetadata?showMetadata:void 0,"undefined"in i?i.undefined:void 0),n.join("")}},{"jade/runtime":7}],38:[function(t,e,n){var r,i,s,o=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=t("backbone"),s=t("underscore"),i=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return o(n,e),n.prototype.template=t("./result.jade"),n.prototype.className="result",n.prototype.tagName="li",n.prototype.initialize=function(t){var e;return this.options=t,null==(e=this.options).fulltext&&(e.fulltext=!1),this.options.fulltext?this.$el.addClass("fulltext"):this.$el.addClass("no-fulltext"),this.render()},n.prototype.render=function(){var t,e,n,r,i;e=[],n=this.options.data.terms;for(r in n)a.call(n,r)&&(t=n[r],e.push(t+"x "+r));return this.options.config.get("templates").hasOwnProperty("result")&&(this.template=this.options.config.get("templates").result),i={data:this.options.data,fulltext:this.options.fulltext,found:e.join(", ")},this.options.config.get("templateData").hasOwnProperty("result")&&(i=s.extend(i,this.options.config.get("templateData").result)),this.$el.html(this.template(i)),this},n.prototype.events=function(){return{click:"_handleClick","click li[data-layer]":"_handleLayerClick"}},n.prototype._handleClick=function(t){return this.trigger("click",this.options.data)},n.prototype._handleLayerClick=function(t){var e;return t.stopPropagation(),e=t.currentTarget.getAttribute("data-layer"),this.trigger("layer:click",e,this.options.data)},n.prototype.destroy=function(){return this.remove()},n}(r.View),e.exports=i},{"./result.jade":39,backbone:void 0,underscore:void 0}],39:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i=t||{};return function(t,i,s,o){t.metadata="undefined"!=typeof t.metadata?t.metadata:[],n.push('<div class="title">'+r.escape(null==(e=t.name)?"":e)+'</div><div class="metadata"><ul>'),function(){var i=t.metadata;if("number"==typeof i.length)for(var s=0,o=i.length;s<o;s++){var a=i[s];n.push('<li><span class="key">'+r.escape(null==(e=s+": ")?"":e)+'</span><span class="value">'+r.escape(null==(e=a)?"":e)+"</span></li>")}else{var o=0;for(var s in i){o++;var a=i[s];n.push('<li><span class="key">'+r.escape(null==(e=s+": ")?"":e)+'</span><span class="value">'+r.escape(null==(e=a)?"":e)+"</span></li>")}}}.call(this),n.push("</ul></div>"),s&&(n.push('<div class="found">'+r.escape(null==(e=i)?"":e)+'</div><div class="keywords"><ul>'),null!=t._kwic&&function(){var i=t._kwic;if("number"==typeof i.length)for(var s=0,o=i.length;s<o;s++){var a=i[s];n.push("<li"+r.attr("data-layer",s,!0,!1)+"><label>"+r.escape(null==(e=s)?"":e)+'</label><ul class="kwic">'),function(){var t=a;if("number"==typeof t.length)for(var r=0,i=t.length;r<i;r++){var s=t[r];n.push("<li>"+(null==(e=s)?"":e)+"</li>")}else{var i=0;for(var r in t){i++;var s=t[r];n.push("<li>"+(null==(e=s)?"":e)+"</li>")}}}.call(this),n.push("</ul></li>")}else{var o=0;for(var s in i){o++;var a=i[s];n.push("<li"+r.attr("data-layer",s,!0,!1)+"><label>"+r.escape(null==(e=s)?"":e)+'</label><ul class="kwic">'),function(){var t=a;if("number"==typeof t.length)for(var r=0,i=t.length;r<i;r++){var s=t[r];n.push("<li>"+(null==(e=s)?"":e)+"</li>")}else{var i=0;for(var r in t){i++;var s=t[r];n.push("<li>"+(null==(e=s)?"":e)+"</li>")}}}.call(this),n.push("</ul></li>")}}}.call(this),n.push("</ul></div>"))}.call(this,"data"in i?i.data:"undefined"!=typeof data?data:void 0,"found"in i?i.found:"undefined"!=typeof found?found:void 0,"fulltext"in i?i.fulltext:"undefined"!=typeof fulltext?fulltext:void 0,"undefined"in i?i.undefined:void 0),n.join("")}},{"jade/runtime":7}],40:[function(t,e,n){var r,i,s,o,a,l=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;i=t("backbone"),r=t("jquery"),o=t("funcky.el").el,a=t("./sort.jade"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.tagName="li",e.prototype.className="sort-levels",e.prototype.initialize=function(t){return this.options=t,this.render(),this.listenTo(this.options.config,"change:initLevels",this.render)},e.prototype.render=function(){var t,e,n;return Object.keys(this.options.config.get("initLevels")).length>0&&(n=a({initLevels:this.options.config.get("initLevels"),levels:this.options.config.get("levels")}),this.$el.html(n),e=this.$("div.levels"),t=function(t){if(!o(e[0]).hasDescendant(t.target)&&e[0]!==t.target)return e.hide()},this.onMouseleave=t.bind(this),e.on("mouseleave",this.onMouseleave)),this},e.prototype.events=function(){return{"click button.toggle":"toggleLevels","click li.search button":"saveLevels","change div.levels select":"changeLevels","click div.levels i.fa":"changeAlphaSort"
}},e.prototype.toggleLevels=function(t){return this.$("div.levels").toggle()},e.prototype.hideLevels=function(){return this.$("div.levels").hide()},e.prototype.changeLevels=function(t){var e,n,r,i,s,o,a,l,c,u,h;for(this.$("div.levels").addClass("show-save-button"),h=t.currentTarget,a=this.el.querySelectorAll("div.levels select"),r=0,s=a.length;r<s;r++)u=a[r],u.name!==h.name&&u.value===h.value&&(u.selectedIndex=0);for(l=this.el.querySelectorAll("div.levels i.fa"),c=[],i=0,o=l.length;i<o;i++)n=l[i],e=this.$(n),e.addClass("fa-sort-alpha-asc"),c.push(e.removeClass("fa-sort-alpha-desc"));return c},e.prototype.changeAlphaSort=function(t){var e;return this.$("div.levels").addClass("show-save-button"),e=this.$(t.currentTarget),e.toggleClass("fa-sort-alpha-asc"),e.toggleClass("fa-sort-alpha-desc")},e.prototype.saveLevels=function(){var t,e,n,i,s,o,a,l;for(l=[],s=this.el.querySelectorAll("div.levels li[name]"),e=0,n=s.length;e<n;e++)i=s[e],o=i.querySelector("select"),t=o.options[o.selectedIndex].value,""!==t&&(a={},a.fieldname=t,a.direction=r(i).find("i.fa").hasClass("fa-sort-alpha-asc")?"asc":"desc",l.push(a));return this.hideLevels(),this.trigger("change",l)},e.prototype.destroy=function(){return this.$("div.levels").off("mouseleave",this.onMouseleave),this.remove()},e}(i.View),e.exports=s},{"./sort.jade":41,backbone:void 0,"funcky.el":3,jquery:void 0}],41:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i=t||{};return function(t,i,s,o){n.push('<button class="toggle">Sort<i class="fa fa-caret-down"></i></button><div class="levels"><ul>'),function(){var o=[1,2,3];if("number"==typeof o.length)for(var a=0,l=o.length;a<l;a++){var c=o[a];n.push("<li"+r.attr("name","level"+c,!0,!1)+"><label>"+r.escape(null==(e="Level "+c)?"":e)+"</label><select"+r.attr("name","level"+c,!0,!1)+"><option></option>"),function(){var o=t.keys(s);if("number"==typeof o.length)for(var a=0,l=o.length;a<l;a++){var u=o[a],h=u==t.keys(i)[c-1];n.push("<option"+r.attr("value",u,!0,!1)+r.attr("selected",h,!0,!1)+">"+r.escape(null==(e=s[u])?"":e)+"</option>")}else{var l=0;for(var a in o){l++;var u=o[a],h=u==t.keys(i)[c-1];n.push("<option"+r.attr("value",u,!0,!1)+r.attr("selected",h,!0,!1)+">"+r.escape(null==(e=s[u])?"":e)+"</option>")}}}.call(this),n.push('</select><i class="fa fa-sort-alpha-asc"></i></li>')}else{var l=0;for(var a in o){l++;var c=o[a];n.push("<li"+r.attr("name","level"+c,!0,!1)+"><label>"+r.escape(null==(e="Level "+c)?"":e)+"</label><select"+r.attr("name","level"+c,!0,!1)+"><option></option>"),function(){var o=t.keys(s);if("number"==typeof o.length)for(var a=0,l=o.length;a<l;a++){var u=o[a],h=u==t.keys(i)[c-1];n.push("<option"+r.attr("value",u,!0,!1)+r.attr("selected",h,!0,!1)+">"+r.escape(null==(e=s[u])?"":e)+"</option>")}else{var l=0;for(var a in o){l++;var u=o[a],h=u==t.keys(i)[c-1];n.push("<option"+r.attr("value",u,!0,!1)+r.attr("selected",h,!0,!1)+">"+r.escape(null==(e=s[u])?"":e)+"</option>")}}}.call(this),n.push('</select><i class="fa fa-sort-alpha-asc"></i></li>')}}}.call(this),n.push('<li class="search">&nbsp;<button>Change levels</button></li></ul></div>')}.call(this,"Object"in i?i.Object:"undefined"!=typeof Object?Object:void 0,"initLevels"in i?i.initLevels:"undefined"!=typeof initLevels?initLevels:void 0,"levels"in i?i.levels:"undefined"!=typeof levels?levels:void 0,"undefined"in i?i.undefined:void 0),n.join("")}},{"jade/runtime":7}],42:[function(t,e,n){var r,i,s,o,a,l,c=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty;r=t("backbone"),o=t("underscore"),i=t("../../models/search"),l=t("./index.jade"),a=t("funcky.util"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.className="text-search",e.prototype.currentField="",e.prototype.initialize=function(t){return this.options=t,this.setModel()},e.prototype.render=function(){return this.options.config.get("templates").hasOwnProperty("text-search")&&(l=this.options.config.get("templates")["text-search"]),this.$el.html(l({model:this.model,config:this.options.config,generateId:a.generateID,currentField:this.currentField})),this},e.prototype.events=function(){return{"click .search-icon":"search",'keyup input[name="search"]':"onKeyUp",'focus input[name="search"]':function(){return this.$(".body .menu").slideDown(150)},"click .menu .fa-times":function(){return this.$(".body .menu").slideUp(150)},'change input[type="checkbox"]':"checkboxChanged",'change input[type="radio"]':"checkboxChanged"}},e.prototype._addFullTextSearchParameters=function(){var t,e,n,r,i;if(t=this.options.config.get("textSearchOptions").fullTextSearchParameters,null!=t){for(this.currentField=t[0],i=[],e=0,n=t.length;e<n;e++)r=t[e],i.push({name:r,term:"*"});return this.model.set({fullTextSearchParameters:i})}},e.prototype.setModel=function(){var t,e;return null!=this.model&&this.stopListening(this.model),e=this.options.config.get("textSearchOptions"),t=o.clone(e),e.caseSensitive?t.caseSensitive=!1:delete t.caseSensitive,e.fuzzy?t.fuzzy=!1:delete t.fuzzy,this.model=new i(t),this.listenTo(this.options.config,"change:textSearchOptions",function(t){return function(e,n,r){var i,s,o,a,l;if(t.model.set(n),i=t.options.config.get("textSearchOptions").fullTextSearchParameters,null!=i){for(t.currentField=i[0],l=[],s=0,o=i.length;s<o;s++)a=i[s],l.push({name:a,term:"*"});t.model.set({fullTextSearchParameters:l})}return t.render()}}(this))},e.prototype._updateFullTextSearchParameters=function(){var t;return t={name:this.currentField,term:this.el.querySelector('input[name="search"]').value},this.model.set({fullTextSearchParameters:[t]})},e.prototype.onKeyUp=function(t){return 13===t.keyCode?(t.preventDefault(),this.search(t)):(this.model.has("term")?this.model.get("term")!==t.currentTarget.value&&this.model.set({term:t.currentTarget.value}):this._updateFullTextSearchParameters(),this.updateQueryModel())},e.prototype.checkboxChanged=function(t){var e,n,r,i,s,o,a,l,c,u,h;if(i=t.currentTarget.getAttribute("data-attr"),s=t.currentTarget.getAttribute("data-attr-array"),e=i)"searchInTranscriptions"===e&&this.$("ul.textlayers").toggle(t.currentTarget.checked),this.model.set(e,t.currentTarget.checked);else if("fullTextSearchParameters"===s){for(u=this.el.querySelectorAll('[data-attr-array="fullTextSearchParameters"]'),o=0,l=u.length;o<l;o++)n=u[o],n.checked&&(this.currentField=n.getAttribute("data-value"));this._updateFullTextSearchParameters()}else if(null!=s){for(r=[],h=this.el.querySelectorAll('[data-attr-array="'+s+'"]'),a=0,c=h.length;a<c;a++)n=h[a],n.checked&&r.push(n.getAttribute("data-value"));this.model.set(s,r)}return this.updateQueryModel()},e.prototype.search=function(t){return t.preventDefault(),this.trigger("search")},e.prototype.updateQueryModel=function(){return this.trigger("change",this.model.attributes)},e.prototype.reset=function(){return this.setModel(),this.render()},e.prototype.destroy=function(){return this.remove()},e}(r.View),e.exports=s},{"../../models/search":18,"./index.jade":43,backbone:void 0,"funcky.util":5,underscore:void 0}],43:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i={},s=t||{};return function(t,s,o,a,l,c,u){i["search-icon"]=e=function(){this&&this.block,this&&this.attributes||{};n.push('<svg viewBox="0 0 250.313 250.313" class="search"><path d="M244.186,214.604l-54.379-54.378c-0.289-0.289-0.628-0.491-0.93-0.76 c10.7-16.231,16.945-35.66,16.945-56.554C205.822,46.075,159.747,0,102.911,0S0,46.075,0,102.911 c0,56.835,46.074,102.911,102.91,102.911c20.895,0,40.323-6.245,56.554-16.945c0.269,0.301,0.47,0.64,0.759,0.929l54.38,54.38 c8.169,8.168,21.413,8.168,29.583,0C252.354,236.017,252.354,222.773,244.186,214.604z M102.911,170.146 c-37.134,0-67.236-30.102-67.236-67.235c0-37.134,30.103-67.236,67.236-67.236c37.132,0,67.235,30.103,67.235,67.236 C170.146,140.044,140.043,170.146,102.911,170.146z"></path></svg>')};var h=t.get("textSearchOptions").fullTextSearchParameters;n.push('<div class="placeholder">'),null!=h&&1===h.length&&n.push("<header><h3>"+r.escape(null==(e=t.get("facetDisplayNames")[h[0]])?"":e)+"</h3></header>"),n.push('<div class="body"><div class="search-input"><input type="text" name="search"/><div class="search-icon">'),i["search-icon"](),n.push('</div></div><div class="menu"><i class="fa fa-times"></i><div class="close"></div><ul class="options">'),t.get("textSearchOptions").caseSensitive&&(a=o(),n.push('<li class="option case-sensitive"><input'+r.attr("id",a,!0,!1)+' type="checkbox" data-attr="caseSensitive"/><label'+r.attr("for",a,!0,!1)+">Match case</label></li>")),t.get("textSearchOptions").fuzzy&&(a=o(),n.push('<li class="option fuzzy"><input'+r.attr("id",a,!0,!1)+' type="checkbox" data-attr="fuzzy"/><label'+r.attr("for",a,!0,!1)+">Fuzzy</label></li>")),(l.has("searchInAnnotations")||l.has("searchInTranscriptions"))&&(n.push('<li class="option search-annotations"><h4>Search in:</h4><ul class="searchins">'),l.has("searchInTranscriptions")&&(a=o(),n.push('<li class="searchin"><input'+r.attr("id",a,!0,!1)+' type="checkbox" data-attr="searchInTranscriptions"'+r.attr("checked",l.get("searchInTranscriptions"),!0,!1)+"/><label"+r.attr("for",a,!0,!1)+">Transcriptions</label></li>")),l.has("searchInAnnotations")&&(a=o(),n.push('<li class="searchin"><input'+r.attr("id",a,!0,!1)+' type="checkbox" data-attr="searchInAnnotations"'+r.attr("checked",l.get("searchInAnnotations"),!0,!1)+"/><label"+r.attr("for",a,!0,!1)+">Annotations</label></li>")),n.push("</ul></li>")),l.has("textLayers")&&l.get("textLayers").length>1&&(n.push('<li class="option search-textlayers"><h4>Textlayers:</h4><ul class="textlayers">'),function(){var t=l.get("textLayers");if("number"==typeof t.length)for(var i=0,s=t.length;i<s;i++){var o=t[i];n.push('<li class="textlayer"><input'+r.attr("id","cb_textlayer"+o,!0,!1)+' type="checkbox" data-attr-array="textLayers"'+r.attr("data-value",o,!0,!1)+' checked="checked"/><label'+r.attr("for","cb_textlayer"+o,!0,!1)+">"+r.escape(null==(e=o)?"":e)+"</label></li>")}else{var s=0;for(var i in t){s++;var o=t[i];n.push('<li class="textlayer"><input'+r.attr("id","cb_textlayer"+o,!0,!1)+' type="checkbox" data-attr-array="textLayers"'+r.attr("data-value",o,!0,!1)+' checked="checked"/><label'+r.attr("for","cb_textlayer"+o,!0,!1)+">"+r.escape(null==(e=o)?"":e)+"</label></li>")}}}.call(this),n.push("</ul></li>")),null!=h&&h.length>1&&(n.push('<li class="option fields">'),c=o(),n.push("<h4>"+r.escape(null==(e=t.get("labels").fullTextSearchParameters)?"":e)+'</h4><ul class="fields">'),function(){var i=h;if("number"==typeof i.length)for(var l=0,u=i.length;l<u;l++){var p=i[l];a=o(),n.push('<li><input type="radio"'+r.attr("checked",p==s,!0,!1)+r.attr("name","textsearchoptions-"+c,!0,!1)+r.attr("id",a,!0,!1)+' data-attr-array="fullTextSearchParameters"'+r.attr("data-value",p,!0,!1)+"/><label"+r.attr("for",a,!0,!1)+">"+r.escape(null==(e=t.get("facetDisplayNames")[p])?"":e)+"</label></li>")}else{var u=0;for(var l in i){u++;var p=i[l];a=o(),n.push('<li><input type="radio"'+r.attr("checked",p==s,!0,!1)+r.attr("name","textsearchoptions-"+c,!0,!1)+r.attr("id",a,!0,!1)+' data-attr-array="fullTextSearchParameters"'+r.attr("data-value",p,!0,!1)+"/><label"+r.attr("for",a,!0,!1)+">"+r.escape(null==(e=t.get("facetDisplayNames")[p])?"":e)+"</label></li>")}}}.call(this),n.push("</ul></li>")),n.push("</ul></div></div></div>")}.call(this,"config"in s?s.config:"undefined"!=typeof config?config:void 0,"currentField"in s?s.currentField:"undefined"!=typeof currentField?currentField:void 0,"generateId"in s?s.generateId:"undefined"!=typeof generateId?generateId:void 0,"id"in s?s.id:"undefined"!=typeof id?id:void 0,"model"in s?s.model:"undefined"!=typeof model?model:void 0,"textSearchId"in s?s.textSearchId:"undefined"!=typeof textSearchId?textSearchId:void 0,"undefined"in s?s.undefined:void 0),n.join("")}},{"jade/runtime":7}],44:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i=t||{};return function(t,i,s,o){n.push("<ul>"),function(){var o=i;if("number"==typeof o.length)for(var a=0,l=o.length;a<l;a++){var c=o[a];t=c.hasOwnProperty("displayName")?c.displayName:c.name,n.push('<li><div class="row span6"><div class="cell span5"><i'+r.attr("data-value",c.name,!0,!1)+r.cls([c.checked?"fa fa-check-square-o":"fa fa-square-o"],[!0])+"></i><label"+r.attr("data-value",c.name,!0,!1)+">"+r.escape(null==(e=s(t))?"":e)+'</label></div><div class="cell span1 alignright"><div class="count">'+r.escape(null==(e=c.count)?"":e)+"</div></div></div></li>")}else{var l=0;for(var a in o){l++;var c=o[a];t=c.hasOwnProperty("displayName")?c.displayName:c.name,n.push('<li><div class="row span6"><div class="cell span5"><i'+r.attr("data-value",c.name,!0,!1)+r.cls([c.checked?"fa fa-check-square-o":"fa fa-square-o"],[!0])+"></i><label"+r.attr("data-value",c.name,!0,!1)+">"+r.escape(null==(e=s(t))?"":e)+'</label></div><div class="cell span1 alignright"><div class="count">'+r.escape(null==(e=c.count)?"":e)+"</div></div></div></li>")}}}.call(this),n.push("</ul>")}.call(this,"displayName"in i?i.displayName:"undefined"!=typeof displayName?displayName:void 0,"options"in i?i.options:"undefined"!=typeof options?options:void 0,"ucfirst"in i?i.ucfirst:"undefined"!=typeof ucfirst?ucfirst:void 0,"undefined"in i?i.undefined:void 0),n.join("")}},{"jade/runtime":7}],45:[function(t,e,n){var r=t("jade/runtime");e.exports=function(t){var e,n=[],i={},s=t||{};return function(t,s,o){i["filter-icon"]=e=function(){var t=(this&&this.block,this&&this.attributes||{});n.push('<svg viewBox="0 0 971.986 971.986"'+r.cls(["filter",t.className],[null,!0])+"><title>"+r.escape(null==(e=t.title)?"":e)+'</title><path d="M370.216,459.3c10.2,11.1,15.8,25.6,15.8,40.6v442c0,26.601,32.1,40.101,51.1,21.4l123.3-141.3 c16.5-19.8,25.6-29.601,25.6-49.2V500c0-15,5.7-29.5,15.8-40.601L955.615,75.5c26.5-28.8,6.101-75.5-33.1-75.5h-873 c-39.2,0-59.7,46.6-33.1,75.5L370.216,459.3z"></path></svg>')},i["sort-count-ascending-icon"]=e=function(){var t=(this&&this.block,this&&this.attributes||{});n.push('<svg viewBox="0 0 511.627 511.627"'+r.cls(["sort-count-ascending",t.className],[null,!0])+"><g><title>"+r.escape(null==(e=t.title)?"":e)+'</title><rect x="0" y="0" width="511.627" height="511.627" fill-opacity="0.01"></rect><path d="M260.494,219.271H388.4c2.666,0,4.855-0.855,6.563-2.57c1.715-1.713,2.573-3.9,2.573-6.567v-54.816 c0-2.667-0.858-4.854-2.573-6.567c-1.708-1.711-3.897-2.57-6.563-2.57H260.494c-2.666,0-4.853,0.855-6.567,2.57 c-1.71,1.713-2.568,3.9-2.568,6.567v54.816c0,2.667,0.855,4.854,2.568,6.567C255.641,218.413,257.828,219.271,260.494,219.271z"></path><path d="M260.497,73.089h73.087c2.666,0,4.856-0.855,6.563-2.568c1.718-1.714,2.563-3.901,2.563-6.567V9.136 c0-2.663-0.846-4.853-2.563-6.567C338.44,0.859,336.25,0,333.584,0h-73.087c-2.666,0-4.853,0.855-6.567,2.568 c-1.709,1.715-2.568,3.905-2.568,6.567v54.818c0,2.666,0.855,4.853,2.568,6.567C255.645,72.23,257.831,73.089,260.497,73.089z"></path><path d="M196.54,401.991h-54.817V9.136c0-2.663-0.854-4.856-2.568-6.567C137.441,0.859,135.254,0,132.587,0H77.769 c-2.663,0-4.856,0.855-6.567,2.568c-1.709,1.715-2.568,3.905-2.568,6.567v392.855H13.816c-4.184,0-7.04,1.902-8.564,5.708 c-1.525,3.621-0.855,6.95,1.997,9.996l91.361,91.365c2.094,1.707,4.281,2.562,6.567,2.562c2.474,0,4.665-0.855,6.567-2.562 l91.076-91.078c1.906-2.279,2.856-4.571,2.856-6.844c0-2.676-0.859-4.859-2.568-6.584 C201.395,402.847,199.208,401.991,196.54,401.991z"></path><path d="M504.604,441.109c-1.715-1.718-3.901-2.573-6.567-2.573H260.497c-2.666,0-4.853,0.855-6.567,2.573 c-1.709,1.711-2.568,3.901-2.568,6.564v54.815c0,2.673,0.855,4.853,2.568,6.571c1.715,1.711,3.901,2.566,6.567,2.566h237.539 c2.666,0,4.853-0.855,6.567-2.566c1.711-1.719,2.566-3.898,2.566-6.571v-54.815C507.173,445.011,506.314,442.82,504.604,441.109z"></path><path d="M260.494,365.445H443.22c2.663,0,4.853-0.855,6.57-2.566c1.708-1.711,2.563-3.901,2.563-6.563v-54.823 c0-2.662-0.855-4.853-2.563-6.563c-1.718-1.711-3.907-2.566-6.57-2.566H260.494c-2.666,0-4.853,0.855-6.567,2.566 c-1.71,1.711-2.568,3.901-2.568,6.563v54.823c0,2.662,0.855,4.853,2.568,6.563C255.641,364.59,257.828,365.445,260.494,365.445z"></path></g></svg>')},i["sort-count-descending-icon"]=e=function(){var t=(this&&this.block,this&&this.attributes||{});n.push('<svg viewBox="0 0 511.627 511.627"'+r.cls(["sort-count-descending",t.className],[null,!0])+"><g><title>"+r.escape(null==(e=t.title)?"":e)+'</title><rect x="0" y="0" width="511.627" height="511.627" fill-opacity="0"></rect><path d="M333.584,438.536h-73.087c-2.666,0-4.853,0.855-6.567,2.573c-1.709,1.711-2.568,3.901-2.568,6.564v54.815 c0,2.673,0.855,4.853,2.568,6.571c1.715,1.711,3.901,2.566,6.567,2.566h73.087c2.666,0,4.856-0.855,6.563-2.566 c1.718-1.719,2.563-3.898,2.563-6.571v-54.815c0-2.663-0.846-4.854-2.563-6.564C338.44,439.392,336.25,438.536,333.584,438.536z"></path><path d="M196.54,401.991h-54.817V9.136c0-2.663-0.854-4.856-2.568-6.567C137.441,0.859,135.254,0,132.587,0H77.769 c-2.663,0-4.856,0.855-6.567,2.568c-1.709,1.715-2.568,3.905-2.568,6.567v392.855H13.816c-4.184,0-7.04,1.902-8.564,5.708 c-1.525,3.621-0.855,6.95,1.997,9.996l91.361,91.365c2.094,1.707,4.281,2.562,6.567,2.562c2.474,0,4.665-0.855,6.567-2.562 l91.076-91.078c1.906-2.279,2.856-4.571,2.856-6.844c0-2.676-0.859-4.859-2.568-6.584 C201.395,402.847,199.208,401.991,196.54,401.991z"></path><path d="M388.4,292.362H260.494c-2.666,0-4.853,0.855-6.567,2.566c-1.71,1.711-2.568,3.901-2.568,6.563v54.823 c0,2.662,0.855,4.853,2.568,6.563c1.714,1.711,3.901,2.566,6.567,2.566H388.4c2.666,0,4.855-0.855,6.563-2.566 c1.715-1.711,2.573-3.901,2.573-6.563v-54.823c0-2.662-0.858-4.853-2.573-6.563C393.256,293.218,391.066,292.362,388.4,292.362z"></path><path d="M504.604,2.568C502.889,0.859,500.702,0,498.036,0H260.497c-2.666,0-4.853,0.855-6.567,2.568 c-1.709,1.715-2.568,3.905-2.568,6.567v54.818c0,2.666,0.855,4.853,2.568,6.567c1.715,1.709,3.901,2.568,6.567,2.568h237.539 c2.666,0,4.853-0.855,6.567-2.568c1.711-1.714,2.566-3.901,2.566-6.567V9.136C507.173,6.473,506.314,4.279,504.604,2.568z"></path><path d="M443.22,146.181H260.494c-2.666,0-4.853,0.855-6.567,2.57c-1.71,1.713-2.568,3.9-2.568,6.567v54.816 c0,2.667,0.855,4.854,2.568,6.567c1.714,1.711,3.901,2.57,6.567,2.57H443.22c2.663,0,4.853-0.855,6.57-2.57 c1.708-1.713,2.563-3.9,2.563-6.567v-54.816c0-2.667-0.855-4.858-2.563-6.567C448.069,147.04,445.879,146.181,443.22,146.181z"></path></g></svg>')},i["sort-alphabetically-ascending-icon"]=e=function(){var t=(this&&this.block,this&&this.attributes||{});n.push('<svg viewBox="0 0 511.626 511.627"'+r.cls(["sort-alphabetically-ascending",t.className],[null,!0])+"><g><title>"+r.escape(null==(e=t.title)?"":e)+'</title><rect x="0" y="0" width="511.627" height="511.627" fill-opacity="0"></rect><path d="M215.232,401.991h-54.818V9.136c0-2.663-0.854-4.856-2.568-6.567C156.133,0.859,153.946,0,151.279,0H96.461 c-2.663,0-4.856,0.855-6.567,2.568c-1.709,1.715-2.568,3.905-2.568,6.567v392.855H32.507c-4.184,0-7.039,1.902-8.563,5.708 c-1.525,3.621-0.856,6.95,1.997,9.996l91.361,91.365c2.096,1.707,4.281,2.562,6.567,2.562c2.474,0,4.664-0.855,6.567-2.562 l91.076-91.078c1.906-2.279,2.856-4.571,2.856-6.844c0-2.676-0.854-4.859-2.568-6.584 C220.086,402.847,217.9,401.991,215.232,401.991z"></path><path d="M428.511,479.082h-70.808c-3.997,0-6.852,0.191-8.559,0.568l-4.001,0.571v-0.571l3.142-3.142 c2.848-3.419,4.853-5.896,5.996-7.409l105.344-151.331v-25.406H297.744v65.377h34.263v-32.832h66.236 c3.422,0,6.283-0.288,8.555-0.855c0.572,0,1.287-0.048,2.143-0.145c0.853-0.085,1.475-0.144,1.852-0.144v0.855l-3.142,2.574 c-1.704,1.711-3.713,4.273-5.995,7.706L296.31,485.934v25.693h166.734v-66.521h-34.54v33.976H428.511z"></path><path d="M468.475,189.008L402.807,0h-46.25l-65.664,189.008h-19.979v30.264h81.933v-30.264h-21.409l13.419-41.112h69.381 l13.415,41.112H406.25v30.264h82.228v-30.264H468.475z M354.278,116.487l20.841-62.241c0.76-2.285,1.479-5.046,2.143-8.28 c0.66-3.236,0.996-4.949,0.996-5.139l0.855-5.708h1.143c0,0.761,0.191,2.664,0.562,5.708l3.433,13.418l20.554,62.241H354.278z"></path></g></svg>')},i["sort-alphabetically-descending-icon"]=e=function(){var t=(this&&this.block,this&&this.attributes||{});n.push('<svg viewBox="0 0 511.626 511.627"'+r.cls(["sort-alphabetically-descending",t.className],[null,!0])+"><g><title>"+r.escape(null==(e=t.title)?"":e)+'</title><rect x="0" y="0" width="511.627" height="511.627" fill-opacity="0"></rect><path d="M215.232,401.991h-54.818V9.136c0-2.663-0.854-4.856-2.568-6.567C156.133,0.859,153.946,0,151.279,0H96.461 c-2.663,0-4.856,0.855-6.567,2.568c-1.709,1.715-2.568,3.905-2.568,6.567v392.855H32.507c-4.184,0-7.039,1.902-8.563,5.708 c-1.525,3.621-0.856,6.95,1.997,9.996l91.361,91.365c2.096,1.707,4.281,2.562,6.567,2.562c2.474,0,4.664-0.855,6.567-2.562 l91.076-91.078c1.906-2.279,2.856-4.571,2.856-6.844c0-2.676-0.854-4.859-2.568-6.584 C220.086,402.847,217.9,401.991,215.232,401.991z"></path><path d="M468.475,481.361l-65.664-189.01h-46.25L290.9,481.364H270.92v30.263h81.934v-30.266h-21.412l13.418-41.11h69.381 l13.415,41.11H406.25v30.266h82.228v-30.266H468.475z M354.278,408.846l20.841-62.242c0.76-2.283,1.479-5.045,2.143-8.278 c0.66-3.234,0.996-4.948,0.996-5.137l0.855-5.715h1.143c0,0.767,0.191,2.669,0.562,5.715l3.433,13.415l20.554,62.242H354.278z"></path><path d="M463.055,152.745h-34.537v33.975H357.71c-4.001,0-6.852,0.097-8.556,0.288l-4.004,0.854v-0.854l3.142-2.858 c2.851-3.422,4.853-5.896,5.996-7.421L459.632,25.41V0H297.754v65.387h34.259V32.552h66.232c3.426,0,6.283-0.288,8.56-0.859 c0.571,0,1.286-0.048,2.142-0.144c0.855-0.094,1.476-0.144,1.854-0.144v0.855l-3.141,2.568c-1.708,1.713-3.71,4.283-5.996,7.71 L296.32,193.569v25.697h166.735V152.745z"></path></g></svg>')},o=s.get("options"),n.push('<div class="placeholder"><header><h3'+r.attr("title",s.get("title"),!0,!1)+">"+r.escape(null==(e=s.get("title"))?"":e)+'</h3><div class="menu">'),null!=o&&null!=o.length&&o.length>9&&(i["filter-icon"].call({attributes:{title:r.escape(t.get("labels").filterOptions)}}),i["sort-count-ascending-icon"].call({attributes:{className:"count",title:r.escape(t.get("labels").sortNumerically)}}),i["sort-count-descending-icon"].call({attributes:{className:"count visible active",title:r.escape(t.get("labels").sortNumerically)}}),i["sort-alphabetically-ascending-icon"].call({attributes:{className:"alpha visible",title:r.escape(t.get("labels").sortAlphabetically)}}),i["sort-alphabetically-descending-icon"].call({attributes:{className:"alpha",title:r.escape(t.get("labels").sortAlphabetically)}})),n.push('</div><div class="options"></div></header><div class="body"></div></div>')}.call(this,"config"in s?s.config:"undefined"!=typeof config?config:void 0,"model"in s?s.model:"undefined"!=typeof model?model:void 0,"options"in s?s.options:"undefined"!=typeof options?options:void 0),n.join("")}},{"jade/runtime":7}],46:[function(t,e,n){t("jade/runtime");e.exports=function(t){var e,n=[],r={};return r["tail-spin-loader-icon"]=e=function(){this&&this.block,this&&this.attributes||{};n.push('<svg viewBox="0 0 38 38"><defs><linearGradient x1="8.042%" y1="0%" x2="65.682%" y2="23.865%" id="z8dZZfS3A"><stop stop-color="#666" stop-opacity="0" offset="0%"></stop><stop stop-color="#666" stop-opacity=".631" offset="63.146%"></stop><stop stop-color="#666" offset="100%"></stop></linearGradient></defs><g fill="none" fill-rule="evenodd"><g transform="translate(1 1)"><path d="M33 18c0-9.94-8.06-18-18-18" stroke="url(#z8dZZfS3A)" stroke-width="4"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="0.9s" repeatCount="indefinite"></animateTransform></path><circle fill="#666" cx="33" cy="18" r="2"><animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="0.9s" repeatCount="indefinite"></animateTransform></circle></g></g></svg>')},n.push('<div class="overlay"><div>'),r["tail-spin-loader-icon"](),n.push('</div></div><div class="faceted-search"><div class="text-search-placeholder"></div><ul class="facets-menu"><li class="reset"><button><i class="fa fa-refresh"></i><span>New search</span></button></li><li class="switch"><button><i class="fa fa-angle-double-up"></i><i class="fa fa-angle-double-down"></i><span class="simple">Simple search</span><span class="advanced">Advanced search</span></button></li><li class="collapse-expand"><button><i class="fa fa-compress"></i><span>Collapse filters</span></button></li></ul><div class="facets-placeholder"></div></div><div class="results"></div>'),n.join("")}},{"jade/runtime":7}]},{},[13])(13)});